{"version":3,"sources":["../../src/queries/buildSortParam.ts"],"sourcesContent":["import type { PaginateOptions } from 'mongoose'\nimport type { Field, SanitizedConfig } from 'payload'\n\nimport { getLocalizedSortProperty } from './getLocalizedSortProperty.js'\n\ntype Args = {\n  config: SanitizedConfig\n  fields: Field[]\n  locale: string\n  sort: string\n  timestamps: boolean\n}\n\nexport type SortArgs = {\n  direction: SortDirection\n  property: string\n}[]\n\nexport type SortDirection = 'asc' | 'desc'\n\nexport const buildSortParam = ({\n  config,\n  fields,\n  locale,\n  sort,\n  timestamps,\n}: Args): PaginateOptions['sort'] => {\n  let sortProperty: string\n  let sortDirection: SortDirection = 'desc'\n\n  if (!sort) {\n    if (timestamps) {\n      sortProperty = 'createdAt'\n    } else {\n      sortProperty = '_id'\n    }\n  } else if (sort.indexOf('-') === 0) {\n    sortProperty = sort.substring(1)\n  } else {\n    sortProperty = sort\n    sortDirection = 'asc'\n  }\n\n  if (sortProperty === 'id') {\n    sortProperty = '_id'\n  } else {\n    sortProperty = getLocalizedSortProperty({\n      config,\n      fields,\n      locale,\n      segments: sortProperty.split('.'),\n    })\n  }\n\n  return { [sortProperty]: sortDirection }\n}\n"],"names":["getLocalizedSortProperty","buildSortParam","config","fields","locale","sort","timestamps","sortProperty","sortDirection","indexOf","substring","segments","split"],"mappings":"AAGA,SAASA,wBAAwB,QAAQ,gCAA+B;AAiBxE,OAAO,MAAMC,iBAAiB,CAAC,EAC7BC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,IAAI,EACJC,UAAU,EACL;IACL,IAAIC;IACJ,IAAIC,gBAA+B;IAEnC,IAAI,CAACH,MAAM;QACT,IAAIC,YAAY;YACdC,eAAe;QACjB,OAAO;YACLA,eAAe;QACjB;IACF,OAAO,IAAIF,KAAKI,OAAO,CAAC,SAAS,GAAG;QAClCF,eAAeF,KAAKK,SAAS,CAAC;IAChC,OAAO;QACLH,eAAeF;QACfG,gBAAgB;IAClB;IAEA,IAAID,iBAAiB,MAAM;QACzBA,eAAe;IACjB,OAAO;QACLA,eAAeP,yBAAyB;YACtCE;YACAC;YACAC;YACAO,UAAUJ,aAAaK,KAAK,CAAC;QAC/B;IACF;IAEA,OAAO;QAAE,CAACL,aAAa,EAAEC;IAAc;AACzC,EAAC"}