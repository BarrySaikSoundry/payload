{"version":3,"sources":["../../../src/resolvers/auth/resetPassword.ts"],"sourcesContent":["import type { Collection } from 'payload'\n\nimport { generatePayloadCookie, isolateObjectProperty, resetPasswordOperation } from 'payload'\n\nimport type { Context } from '../types.js'\n\nfunction resetPasswordResolver(collection: Collection): any {\n  async function resolver(_, args, context: Context) {\n    if (args.locale) context.req.locale = args.locale\n    if (args.fallbackLocale) context.req.fallbackLocale = args.fallbackLocale\n\n    const options = {\n      api: 'GraphQL',\n      collection,\n      data: args,\n      depth: 0,\n      req: isolateObjectProperty(context.req, 'transactionID'),\n    }\n\n    const result = await resetPasswordOperation(options)\n    const cookie = generatePayloadCookie({\n      collectionConfig: collection.config,\n      payload: context.req.payload,\n      token: result.token,\n    })\n    context.headers['Set-Cookie'] = cookie\n\n    if (collection.config.auth.removeTokenFromResponses) {\n      delete result.token\n    }\n\n    return result\n  }\n\n  return resolver\n}\n\nexport default resetPasswordResolver\n"],"names":["generatePayloadCookie","isolateObjectProperty","resetPasswordOperation","resetPasswordResolver","collection","resolver","_","args","context","locale","req","fallbackLocale","options","api","data","depth","result","cookie","collectionConfig","config","payload","token","headers","auth","removeTokenFromResponses"],"mappings":"AAEA,SAASA,qBAAqB,EAAEC,qBAAqB,EAAEC,sBAAsB,QAAQ,UAAS;AAI9F,SAASC,sBAAsBC,UAAsB;IACnD,eAAeC,SAASC,CAAC,EAAEC,IAAI,EAAEC,OAAgB;QAC/C,IAAID,KAAKE,MAAM,EAAED,QAAQE,GAAG,CAACD,MAAM,GAAGF,KAAKE,MAAM;QACjD,IAAIF,KAAKI,cAAc,EAAEH,QAAQE,GAAG,CAACC,cAAc,GAAGJ,KAAKI,cAAc;QAEzE,MAAMC,UAAU;YACdC,KAAK;YACLT;YACAU,MAAMP;YACNQ,OAAO;YACPL,KAAKT,sBAAsBO,QAAQE,GAAG,EAAE;QAC1C;QAEA,MAAMM,SAAS,MAAMd,uBAAuBU;QAC5C,MAAMK,SAASjB,sBAAsB;YACnCkB,kBAAkBd,WAAWe,MAAM;YACnCC,SAASZ,QAAQE,GAAG,CAACU,OAAO;YAC5BC,OAAOL,OAAOK,KAAK;QACrB;QACAb,QAAQc,OAAO,CAAC,aAAa,GAAGL;QAEhC,IAAIb,WAAWe,MAAM,CAACI,IAAI,CAACC,wBAAwB,EAAE;YACnD,OAAOR,OAAOK,KAAK;QACrB;QAEA,OAAOL;IACT;IAEA,OAAOX;AACT;AAEA,eAAeF,sBAAqB"}