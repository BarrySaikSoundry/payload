{"version":3,"sources":["../../../src/resolvers/collections/update.ts"],"sourcesContent":["import type { Collection, CollectionSlug, DataFromCollectionSlug, PayloadRequest } from 'payload'\n\nimport { isolateObjectProperty, updateByIDOperation } from 'payload'\n\nimport type { Context } from '../types.js'\n\nexport type Resolver<TSlug extends CollectionSlug> = (\n  _: unknown,\n  args: {\n    autosave: boolean\n    data: DataFromCollectionSlug<TSlug>\n    draft: boolean\n    fallbackLocale?: string\n    id: number | string\n    locale?: string\n  },\n  context: {\n    req: PayloadRequest\n  },\n) => Promise<DataFromCollectionSlug<TSlug>>\n\nexport function updateResolver<TSlug extends CollectionSlug>(\n  collection: Collection,\n): Resolver<TSlug> {\n  return async function resolver(_, args, context: Context) {\n    let { req } = context\n    const locale = req.locale\n    const fallbackLocale = req.fallbackLocale\n    req = isolateObjectProperty(req, 'locale')\n    req = isolateObjectProperty(req, 'fallbackLocale')\n    req.locale = args.locale || locale\n    req.fallbackLocale = args.fallbackLocale || fallbackLocale\n    if (!req.query) req.query = {}\n\n    const draft: boolean =\n      args.draft ?? req.query?.draft === 'false'\n        ? false\n        : req.query?.draft === 'true'\n          ? true\n          : undefined\n    if (typeof draft === 'boolean') req.query.draft = String(draft)\n\n    context.req = req\n\n    const options = {\n      id: args.id,\n      autosave: args.autosave,\n      collection,\n      data: args.data as any,\n      depth: 0,\n      draft: args.draft,\n      req: isolateObjectProperty(req, 'transactionID'),\n    }\n\n    const result = await updateByIDOperation<TSlug>(options)\n\n    return result\n  }\n}\n"],"names":["isolateObjectProperty","updateByIDOperation","updateResolver","collection","resolver","_","args","context","req","locale","fallbackLocale","query","draft","undefined","String","options","id","autosave","data","depth","result"],"mappings":"AAEA,SAASA,qBAAqB,EAAEC,mBAAmB,QAAQ,UAAS;AAmBpE,OAAO,SAASC,eACdC,UAAsB;IAEtB,OAAO,eAAeC,SAASC,CAAC,EAAEC,IAAI,EAAEC,OAAgB;QACtD,IAAI,EAAEC,GAAG,EAAE,GAAGD;QACd,MAAME,SAASD,IAAIC,MAAM;QACzB,MAAMC,iBAAiBF,IAAIE,cAAc;QACzCF,MAAMR,sBAAsBQ,KAAK;QACjCA,MAAMR,sBAAsBQ,KAAK;QACjCA,IAAIC,MAAM,GAAGH,KAAKG,MAAM,IAAIA;QAC5BD,IAAIE,cAAc,GAAGJ,KAAKI,cAAc,IAAIA;QAC5C,IAAI,CAACF,IAAIG,KAAK,EAAEH,IAAIG,KAAK,GAAG,CAAC;QAE7B,MAAMC,QACJN,KAAKM,KAAK,IAAIJ,IAAIG,KAAK,EAAEC,UAAU,UAC/B,QACAJ,IAAIG,KAAK,EAAEC,UAAU,SACnB,OACAC;QACR,IAAI,OAAOD,UAAU,WAAWJ,IAAIG,KAAK,CAACC,KAAK,GAAGE,OAAOF;QAEzDL,QAAQC,GAAG,GAAGA;QAEd,MAAMO,UAAU;YACdC,IAAIV,KAAKU,EAAE;YACXC,UAAUX,KAAKW,QAAQ;YACvBd;YACAe,MAAMZ,KAAKY,IAAI;YACfC,OAAO;YACPP,OAAON,KAAKM,KAAK;YACjBJ,KAAKR,sBAAsBQ,KAAK;QAClC;QAEA,MAAMY,SAAS,MAAMnB,oBAA2Bc;QAEhD,OAAOK;IACT;AACF"}