{"version":3,"sources":["../../src/config/schema.ts"],"sourcesContent":["import joi from 'joi'\n\nimport { adminViewSchema } from './shared/adminViewSchema.js'\nimport { componentSchema, livePreviewSchema } from './shared/componentSchema.js'\nimport { openGraphSchema } from './shared/openGraphSchema.js'\n\nconst component = joi.alternatives().try(joi.object().unknown(), joi.func())\n\nexport const endpointsSchema = joi.alternatives().try(\n  joi.array().items(\n    joi.object({\n      custom: joi.object().pattern(joi.string(), joi.any()),\n      handler: joi.alternatives().try(joi.array().items(joi.func()), joi.func()),\n      method: joi\n        .string()\n        .valid('get', 'head', 'post', 'put', 'patch', 'delete', 'connect', 'options'),\n      path: joi.string(),\n      root: joi.bool(),\n    }),\n  ),\n  joi.boolean(),\n)\n\nexport default joi.object({\n  admin: joi.object({\n    autoLogin: joi.alternatives().try(\n      joi.object().keys({\n        email: joi.string(),\n        password: joi.string(),\n        prefillOnly: joi.boolean(),\n        username: joi.string(),\n      }),\n      joi.boolean(),\n    ),\n    avatar: joi.alternatives().try(joi.string(), component),\n    buildPath: joi.string(),\n    components: joi.object().keys({\n      Nav: component,\n      actions: joi.array().items(component),\n      afterDashboard: joi.array().items(component),\n      afterLogin: joi.array().items(component),\n      afterNavLinks: joi.array().items(component),\n      beforeDashboard: joi.array().items(component),\n      beforeLogin: joi.array().items(component),\n      beforeNavLinks: joi.array().items(component),\n      graphics: joi.object({\n        Icon: component,\n        Logo: component,\n      }),\n      logout: joi.object({\n        Button: component,\n      }),\n      providers: joi.array().items(component),\n      views: joi.alternatives().try(\n        joi.object({\n          Account: joi.alternatives().try(component, adminViewSchema),\n          Dashboard: joi.alternatives().try(component, adminViewSchema),\n        }),\n        joi.object().pattern(joi.string(), component),\n      ),\n    }),\n    custom: joi.object().pattern(joi.string(), joi.any()),\n    dateFormat: joi.string(),\n    disable: joi.bool(),\n    livePreview: joi.object({\n      ...livePreviewSchema,\n      collections: joi.array().items(joi.string()),\n      globals: joi.array().items(joi.string()),\n    }),\n    meta: joi.object().keys({\n      defaultOGImageType: joi.string().valid('off', 'dynamic', 'static'),\n      description: joi.string(),\n      icons: joi.array().items(\n        joi.object().keys({\n          type: joi.string(),\n          color: joi.string(),\n          fetchPriority: joi.string().valid('auto', 'high', 'low'),\n          media: joi.string(),\n          rel: joi.string(),\n          sizes: joi.string(),\n          url: joi.string(),\n        }),\n      ),\n      openGraph: openGraphSchema,\n      titleSuffix: joi.string(),\n    }),\n    routes: joi.object({\n      account: joi.string(),\n      createFirstUser: joi.string(),\n      forgot: joi.string(),\n      inactivity: joi.string(),\n      login: joi.string(),\n      logout: joi.string(),\n      reset: joi.string(),\n      unauthorized: joi.string(),\n    }),\n    user: joi.string(),\n  }),\n  bin: joi.array().items(\n    joi.object().keys({\n      key: joi.string(),\n      scriptPath: joi.string(),\n    }),\n  ),\n  collections: joi.array(),\n  cookiePrefix: joi.string(),\n  cors: [\n    joi.string().valid('*'),\n    joi.array().items(joi.string()),\n    joi.object().keys({\n      headers: joi.array().items(joi.string()),\n      origins: [joi.string().valid('*'), joi.array().items(joi.string())],\n    }),\n  ],\n  csrf: joi.array().items(joi.string().allow('')).sparse(),\n  custom: joi.object().pattern(joi.string(), joi.any()),\n  db: joi.any(),\n  debug: joi.boolean(),\n  defaultDepth: joi.number().min(0).max(30),\n  defaultMaxTextLength: joi.number(),\n  editor: joi\n    .object()\n    .optional()\n    .keys({\n      CellComponent: componentSchema.optional(),\n      FieldComponent: componentSchema.optional(),\n      afterReadPromise: joi.func().optional(),\n      outputSchema: joi.func().optional(),\n      populationPromise: joi.func().optional(),\n      validate: joi.func().required(),\n    })\n    .unknown(),\n  email: joi.alternatives().try(joi.object(), joi.func()),\n  endpoints: endpointsSchema,\n  globals: joi.array(),\n  graphQL: joi.object().keys({\n    disable: joi.boolean(),\n    disablePlaygroundInProduction: joi.boolean(),\n    maxComplexity: joi.number(),\n    mutations: joi.function(),\n    queries: joi.function(),\n    schemaOutputFile: joi.string(),\n  }),\n  hooks: joi.object().keys({\n    afterError: joi.func(),\n  }),\n  i18n: joi.object(),\n  indexSortableFields: joi.boolean(),\n  local: joi.boolean(),\n  localization: joi.alternatives().try(\n    joi.object().keys({\n      defaultLocale: joi.string(),\n      fallback: joi.boolean(),\n      localeCodes: joi.array().items(joi.string()),\n      locales: joi.alternatives().try(\n        joi.array().items(\n          joi.object().keys({\n            code: joi.string(),\n            fallbackLocale: joi.string(),\n            label: joi\n              .alternatives()\n              .try(\n                joi.object().pattern(joi.string(), [joi.string()]),\n                joi.string(),\n                joi.valid(false),\n              ),\n            rtl: joi.boolean(),\n            toString: joi.func(),\n          }),\n        ),\n        joi.array().items(joi.string()),\n      ),\n    }),\n    joi.boolean(),\n  ),\n  maxDepth: joi.number().min(0).max(100),\n  onInit: joi.func(),\n  plugins: joi.array().items(joi.func()),\n  routes: joi.object({\n    admin: joi.string(),\n    api: joi.string(),\n    graphQL: joi.string(),\n    graphQLPlayground: joi.string(),\n  }),\n  secret: joi.string(),\n  serverURL: joi\n    .string()\n    .uri()\n    .allow('')\n    .custom((value, helper) => {\n      const urlWithoutProtocol = value.split('//')[1]\n\n      if (!urlWithoutProtocol) {\n        return helper.message({\n          custom: 'You need to include either \"https://\" or \"http://\" in your serverURL.',\n        })\n      }\n\n      if (urlWithoutProtocol.indexOf('/') > -1) {\n        return helper.message({\n          custom:\n            'Your serverURL cannot have a path. It can only contain a protocol, a domain, and an optional port.',\n        })\n      }\n\n      return value\n    }),\n  sharp: joi.any(),\n  telemetry: joi.boolean(),\n  typescript: joi.object({\n    autoGenerate: joi.boolean(),\n    declare: joi.alternatives().try(joi.boolean(), joi.object({ ignoreTSError: joi.boolean() })),\n    outputFile: joi.string(),\n    schema: joi.array().items(joi.func()),\n  }),\n  upload: joi.object(),\n})\n"],"names":["joi","adminViewSchema","componentSchema","livePreviewSchema","openGraphSchema","component","alternatives","try","object","unknown","func","endpointsSchema","array","items","custom","pattern","string","any","handler","method","valid","path","root","bool","boolean","admin","autoLogin","keys","email","password","prefillOnly","username","avatar","buildPath","components","Nav","actions","afterDashboard","afterLogin","afterNavLinks","beforeDashboard","beforeLogin","beforeNavLinks","graphics","Icon","Logo","logout","Button","providers","views","Account","Dashboard","dateFormat","disable","livePreview","collections","globals","meta","defaultOGImageType","description","icons","type","color","fetchPriority","media","rel","sizes","url","openGraph","titleSuffix","routes","account","createFirstUser","forgot","inactivity","login","reset","unauthorized","user","bin","key","scriptPath","cookiePrefix","cors","headers","origins","csrf","allow","sparse","db","debug","defaultDepth","number","min","max","defaultMaxTextLength","editor","optional","CellComponent","FieldComponent","afterReadPromise","outputSchema","populationPromise","validate","required","endpoints","graphQL","disablePlaygroundInProduction","maxComplexity","mutations","function","queries","schemaOutputFile","hooks","afterError","i18n","indexSortableFields","local","localization","defaultLocale","fallback","localeCodes","locales","code","fallbackLocale","label","rtl","toString","maxDepth","onInit","plugins","api","graphQLPlayground","secret","serverURL","uri","value","helper","urlWithoutProtocol","split","message","indexOf","sharp","telemetry","typescript","autoGenerate","declare","ignoreTSError","outputFile","schema","upload"],"mappings":"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"}