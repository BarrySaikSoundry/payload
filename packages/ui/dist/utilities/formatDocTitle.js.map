{"version":3,"sources":["../../src/utilities/formatDocTitle.ts"],"sourcesContent":["import type { I18n } from '@payloadcms/translations'\nimport type {\n  ClientCollectionConfig,\n  ClientGlobalConfig,\n  SanitizedConfig,\n  TypeWithID,\n} from 'payload'\n\nimport { getTranslation } from '@payloadcms/translations'\n\nimport { formatDate } from '../utilities/formatDate.js'\n\nexport const formatDocTitle = ({\n  collectionConfig,\n  data,\n  dateFormat: dateFormatFromConfig,\n  fallback,\n  globalConfig,\n  i18n,\n}: {\n  collectionConfig?: ClientCollectionConfig\n  data: TypeWithID\n  dateFormat: SanitizedConfig['admin']['dateFormat']\n  fallback?: string\n  globalConfig?: ClientGlobalConfig\n  i18n: I18n<any, any>\n}): string => {\n  let title: string\n\n  if (collectionConfig) {\n    const useAsTitle = collectionConfig?.admin?.useAsTitle\n\n    if (useAsTitle) {\n      title = data?.[useAsTitle] || title\n\n      if (title) {\n        const fieldConfig = collectionConfig.fields.find(\n          (f) => 'name' in f && f.name === useAsTitle,\n        )\n\n        const isDate = fieldConfig?.type === 'date'\n\n        if (isDate) {\n          const dateFormat =\n            ('date' in fieldConfig.admin && fieldConfig?.admin?.date?.displayFormat) ||\n            dateFormatFromConfig\n          title = formatDate({ date: title, i18n, pattern: dateFormat }) || title\n        }\n      }\n    }\n  }\n\n  if (globalConfig) {\n    title = getTranslation(globalConfig?.label, i18n) || globalConfig?.slug\n  }\n\n  if (!title) {\n    title = fallback || `[${i18n.t('general:untitled')}]`\n  }\n\n  return title\n}\n"],"names":["getTranslation","formatDate","formatDocTitle","collectionConfig","data","dateFormat","dateFormatFromConfig","fallback","globalConfig","i18n","title","useAsTitle","admin","fieldConfig","fields","find","f","name","isDate","type","date","displayFormat","pattern","label","slug","t"],"mappings":"AAQA,SAASA,cAAc,QAAQ,2BAA0B;AAEzD,SAASC,UAAU,QAAQ,6BAA4B;AAEvD,OAAO,MAAMC,iBAAiB,CAAC,EAC7BC,gBAAgB,EAChBC,IAAI,EACJC,YAAYC,oBAAoB,EAChCC,QAAQ,EACRC,YAAY,EACZC,IAAI,EAQL;IACC,IAAIC;IAEJ,IAAIP,kBAAkB;QACpB,MAAMQ,aAAaR,kBAAkBS,OAAOD;QAE5C,IAAIA,YAAY;YACdD,QAAQN,MAAM,CAACO,WAAW,IAAID;YAE9B,IAAIA,OAAO;gBACT,MAAMG,cAAcV,iBAAiBW,MAAM,CAACC,IAAI,CAC9C,CAACC,IAAM,UAAUA,KAAKA,EAAEC,IAAI,KAAKN;gBAGnC,MAAMO,SAASL,aAAaM,SAAS;gBAErC,IAAID,QAAQ;oBACV,MAAMb,aACJ,AAAC,UAAUQ,YAAYD,KAAK,IAAIC,aAAaD,OAAOQ,MAAMC,iBAC1Df;oBACFI,QAAQT,WAAW;wBAAEmB,MAAMV;wBAAOD;wBAAMa,SAASjB;oBAAW,MAAMK;gBACpE;YACF;QACF;IACF;IAEA,IAAIF,cAAc;QAChBE,QAAQV,eAAeQ,cAAce,OAAOd,SAASD,cAAcgB;IACrE;IAEA,IAAI,CAACd,OAAO;QACVA,QAAQH,YAAY,CAAC,CAAC,EAAEE,KAAKgB,CAAC,CAAC,oBAAoB,CAAC,CAAC;IACvD;IAEA,OAAOf;AACT,EAAC"}