{"version":3,"sources":["../../../src/providers/Theme/index.tsx"],"sourcesContent":["'use client'\nimport React, { createContext, useCallback, useContext, useEffect, useState } from 'react'\n\nexport type Theme = 'dark' | 'light'\n\nexport type ThemeContext = {\n  autoMode: boolean\n  setTheme: (theme: Theme) => void\n  theme: Theme\n}\n\nconst initialContext: ThemeContext = {\n  autoMode: true,\n  setTheme: () => null,\n  theme: 'light',\n}\n\nconst Context = createContext(initialContext)\n\nfunction setCookie(cname, cvalue, exdays) {\n  const d = new Date()\n  d.setTime(d.getTime() + exdays * 24 * 60 * 60 * 1000)\n  const expires = 'expires=' + d.toUTCString()\n  document.cookie = cname + '=' + cvalue + ';' + expires + ';path=/'\n}\n\nconst getTheme = (\n  cookieKey,\n): {\n  theme: Theme\n  themeFromCookies: null | string\n} => {\n  let theme: Theme\n\n  const themeFromCookies = window.document.cookie\n    .split('; ')\n    .find((row) => row.startsWith(`${cookieKey}=`))\n    ?.split('=')[1]\n\n  if (themeFromCookies === 'light' || themeFromCookies === 'dark') {\n    theme = themeFromCookies\n  } else {\n    theme =\n      window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches\n        ? 'dark'\n        : 'light'\n  }\n\n  document.documentElement.setAttribute('data-theme', theme)\n\n  return { theme, themeFromCookies }\n}\n\nexport const defaultTheme = 'light'\n\nexport const ThemeProvider: React.FC<{\n  children?: React.ReactNode\n  cookiePrefix?: string\n  theme?: Theme\n}> = ({ children, cookiePrefix, theme: initialTheme }) => {\n  const cookieKey = `${cookiePrefix || 'payload'}-theme`\n\n  const [theme, setThemeState] = useState<Theme>(initialTheme || defaultTheme)\n\n  const [autoMode, setAutoMode] = useState<boolean>()\n\n  useEffect(() => {\n    const { theme, themeFromCookies } = getTheme(cookieKey)\n    setThemeState(theme)\n    setAutoMode(!themeFromCookies)\n  }, [cookieKey])\n\n  const setTheme = useCallback(\n    (themeToSet: 'auto' | Theme) => {\n      if (themeToSet === 'light' || themeToSet === 'dark') {\n        setThemeState(themeToSet)\n        setAutoMode(false)\n        setCookie(cookieKey, themeToSet, 365)\n        document.documentElement.setAttribute('data-theme', themeToSet)\n      } else if (themeToSet === 'auto') {\n        // to delete the cookie, we set an expired date\n        setCookie(cookieKey, themeToSet, -1)\n        const themeFromOS =\n          window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches\n            ? 'dark'\n            : 'light'\n        document.documentElement.setAttribute('data-theme', themeFromOS)\n        setAutoMode(true)\n        setThemeState(themeFromOS)\n      }\n    },\n    [cookieKey],\n  )\n\n  return <Context.Provider value={{ autoMode, setTheme, theme }}>{children}</Context.Provider>\n}\n\nexport const useTheme = (): ThemeContext => useContext(Context)\n"],"names":["React","createContext","useCallback","useContext","useEffect","useState","initialContext","autoMode","setTheme","theme","Context","setCookie","cname","cvalue","exdays","d","Date","setTime","getTime","expires","toUTCString","document","cookie","getTheme","cookieKey","themeFromCookies","window","split","find","row","startsWith","matchMedia","matches","documentElement","setAttribute","defaultTheme","ThemeProvider","children","cookiePrefix","initialTheme","setThemeState","setAutoMode","themeToSet","themeFromOS","Provider","value","useTheme"],"mappings":"AAAA;;AACA,OAAOA,SAASC,aAAa,EAAEC,WAAW,EAAEC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,QAAO;AAU1F,MAAMC,iBAA+B;IACnCC,UAAU;IACVC,UAAU,IAAM;IAChBC,OAAO;AACT;AAEA,MAAMC,wBAAUT,cAAcK;AAE9B,SAASK,UAAUC,KAAK,EAAEC,MAAM,EAAEC,MAAM;IACtC,MAAMC,IAAI,IAAIC;IACdD,EAAEE,OAAO,CAACF,EAAEG,OAAO,KAAKJ,SAAS,KAAK,KAAK,KAAK;IAChD,MAAMK,UAAU,aAAaJ,EAAEK,WAAW;IAC1CC,SAASC,MAAM,GAAGV,QAAQ,MAAMC,SAAS,MAAMM,UAAU;AAC3D;AAEA,MAAMI,WAAW,CACfC;IAKA,IAAIf;IAEJ,MAAMgB,mBAAmBC,OAAOL,QAAQ,CAACC,MAAM,CAC5CK,KAAK,CAAC,MACNC,IAAI,CAAC,CAACC,MAAQA,IAAIC,UAAU,CAAC,CAAC,EAAEN,UAAU,CAAC,CAAC,IAC3CG,MAAM,IAAI,CAAC,EAAE;IAEjB,IAAIF,qBAAqB,WAAWA,qBAAqB,QAAQ;QAC/DhB,QAAQgB;IACV,OAAO;QACLhB,QACEiB,OAAOK,UAAU,IAAIL,OAAOK,UAAU,CAAC,gCAAgCC,OAAO,GAC1E,SACA;IACR;IAEAX,SAASY,eAAe,CAACC,YAAY,CAAC,cAAczB;IAEpD,OAAO;QAAEA;QAAOgB;IAAiB;AACnC;AAEA,OAAO,MAAMU,eAAe,QAAO;AAEnC,OAAO,MAAMC,gBAIR,CAAC,EAAEC,QAAQ,EAAEC,YAAY,EAAE7B,OAAO8B,YAAY,EAAE;IACnD,MAAMf,YAAY,CAAC,EAAEc,gBAAgB,UAAU,MAAM,CAAC;IAEtD,MAAM,CAAC7B,OAAO+B,cAAc,GAAGnC,SAAgBkC,gBAAgBJ;IAE/D,MAAM,CAAC5B,UAAUkC,YAAY,GAAGpC;IAEhCD,UAAU;QACR,MAAM,EAAEK,KAAK,EAAEgB,gBAAgB,EAAE,GAAGF,SAASC;QAC7CgB,cAAc/B;QACdgC,YAAY,CAAChB;IACf,GAAG;QAACD;KAAU;IAEd,MAAMhB,WAAWN,YACf,CAACwC;QACC,IAAIA,eAAe,WAAWA,eAAe,QAAQ;YACnDF,cAAcE;YACdD,YAAY;YACZ9B,UAAUa,WAAWkB,YAAY;YACjCrB,SAASY,eAAe,CAACC,YAAY,CAAC,cAAcQ;QACtD,OAAO,IAAIA,eAAe,QAAQ;YAChC,+CAA+C;YAC/C/B,UAAUa,WAAWkB,YAAY,CAAC;YAClC,MAAMC,cACJjB,OAAOK,UAAU,IAAIL,OAAOK,UAAU,CAAC,gCAAgCC,OAAO,GAC1E,SACA;YACNX,SAASY,eAAe,CAACC,YAAY,CAAC,cAAcS;YACpDF,YAAY;YACZD,cAAcG;QAChB;IACF,GACA;QAACnB;KAAU;IAGb,qBAAO,KAACd,QAAQkC,QAAQ;QAACC,OAAO;YAAEtC;YAAUC;YAAUC;QAAM;kBAAI4B;;AAClE,EAAC;AAED,OAAO,MAAMS,WAAW,IAAoB3C,WAAWO,SAAQ"}