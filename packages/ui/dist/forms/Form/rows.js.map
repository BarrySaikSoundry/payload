{"version":3,"sources":["../../../src/forms/Form/rows.ts"],"sourcesContent":["import type { FormState } from 'payload'\n\ntype Result = {\n  remainingFields: FormState\n  rows: FormState[]\n}\n\nexport const separateRows = (path: string, fields: FormState): Result => {\n  const remainingFields: FormState = {}\n\n  const rows = Object.entries(fields).reduce((incomingRows, [fieldPath, field]) => {\n    const newRows = incomingRows\n\n    if (fieldPath.indexOf(`${path}.`) === 0) {\n      const [rowIndex] = fieldPath.replace(`${path}.`, '').split('.')\n      if (!newRows[rowIndex]) newRows[rowIndex] = {}\n      newRows[rowIndex][fieldPath.replace(`${path}.${String(rowIndex)}.`, '')] = { ...field }\n    } else {\n      remainingFields[fieldPath] = field\n    }\n\n    return newRows\n  }, [])\n\n  return {\n    remainingFields,\n    rows,\n  }\n}\n\nexport const flattenRows = (path: string, rows: FormState[]): FormState => {\n  return rows.reduce(\n    (fields, row, i) => ({\n      ...fields,\n      ...Object.entries(row).reduce((subFields, [subPath, subField]) => {\n        return {\n          ...subFields,\n          [`${path}.${i}.${subPath}`]: { ...subField },\n        }\n      }, {}),\n    }),\n    {},\n  )\n}\n"],"names":["separateRows","path","fields","remainingFields","rows","Object","entries","reduce","incomingRows","fieldPath","field","newRows","indexOf","rowIndex","replace","split","String","flattenRows","row","i","subFields","subPath","subField"],"mappings":"AAOA,OAAO,MAAMA,eAAe,CAACC,MAAcC;IACzC,MAAMC,kBAA6B,CAAC;IAEpC,MAAMC,OAAOC,OAAOC,OAAO,CAACJ,QAAQK,MAAM,CAAC,CAACC,cAAc,CAACC,WAAWC,MAAM;QAC1E,MAAMC,UAAUH;QAEhB,IAAIC,UAAUG,OAAO,CAAC,CAAC,EAAEX,KAAK,CAAC,CAAC,MAAM,GAAG;YACvC,MAAM,CAACY,SAAS,GAAGJ,UAAUK,OAAO,CAAC,CAAC,EAAEb,KAAK,CAAC,CAAC,EAAE,IAAIc,KAAK,CAAC;YAC3D,IAAI,CAACJ,OAAO,CAACE,SAAS,EAAEF,OAAO,CAACE,SAAS,GAAG,CAAC;YAC7CF,OAAO,CAACE,SAAS,CAACJ,UAAUK,OAAO,CAAC,CAAC,EAAEb,KAAK,CAAC,EAAEe,OAAOH,UAAU,CAAC,CAAC,EAAE,IAAI,GAAG;gBAAE,GAAGH,KAAK;YAAC;QACxF,OAAO;YACLP,eAAe,CAACM,UAAU,GAAGC;QAC/B;QAEA,OAAOC;IACT,GAAG,EAAE;IAEL,OAAO;QACLR;QACAC;IACF;AACF,EAAC;AAED,OAAO,MAAMa,cAAc,CAAChB,MAAcG;IACxC,OAAOA,KAAKG,MAAM,CAChB,CAACL,QAAQgB,KAAKC,IAAO,CAAA;YACnB,GAAGjB,MAAM;YACT,GAAGG,OAAOC,OAAO,CAACY,KAAKX,MAAM,CAAC,CAACa,WAAW,CAACC,SAASC,SAAS;gBAC3D,OAAO;oBACL,GAAGF,SAAS;oBACZ,CAAC,CAAC,EAAEnB,KAAK,CAAC,EAAEkB,EAAE,CAAC,EAAEE,QAAQ,CAAC,CAAC,EAAE;wBAAE,GAAGC,QAAQ;oBAAC;gBAC7C;YACF,GAAG,CAAC,EAAE;QACR,CAAA,GACA,CAAC;AAEL,EAAC"}