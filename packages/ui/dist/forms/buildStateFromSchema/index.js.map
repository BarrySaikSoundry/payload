{"version":3,"sources":["../../../src/forms/buildStateFromSchema/index.tsx"],"sourcesContent":["import type {\n  Data,\n  DocumentPreferences,\n  Field as FieldSchema,\n  FormState,\n  PayloadRequest,\n} from 'payload'\n\nimport { calculateDefaultValues } from './calculateDefaultValues/index.js'\nimport { iterateFields } from './iterateFields.js'\n\ntype Args = {\n  data?: Data\n  fieldSchema: FieldSchema[] | undefined\n  id?: number | string\n  operation?: 'create' | 'update'\n  preferences: DocumentPreferences\n  req: PayloadRequest\n  siblingData?: Data\n}\n\nexport type BuildFormStateArgs = {\n  collectionSlug?: string\n  data?: Data\n  docPreferences?: DocumentPreferences\n  formState?: FormState\n  globalSlug?: string\n  id?: number | string\n  locale?: string\n  operation?: 'create' | 'update'\n  schemaPath: string\n}\n\nexport const buildStateFromSchema = async (args: Args): Promise<FormState> => {\n  const { id, data: fullData = {}, fieldSchema, operation, preferences, req } = args\n\n  if (fieldSchema) {\n    const state: FormState = {}\n\n    const dataWithDefaultValues = await calculateDefaultValues({\n      id,\n      data: fullData,\n      fields: fieldSchema,\n      locale: req.locale,\n      siblingData: fullData,\n      user: req.user,\n    })\n\n    await iterateFields({\n      id,\n      addErrorPathToParent: null,\n      data: dataWithDefaultValues,\n      fields: fieldSchema,\n      fullData,\n      operation,\n      parentPassesCondition: true,\n      path: '',\n      preferences,\n      req,\n      state,\n    })\n\n    return state\n  }\n\n  return {}\n}\n\nexport { iterateFields }\n"],"names":["calculateDefaultValues","iterateFields","buildStateFromSchema","args","id","data","fullData","fieldSchema","operation","preferences","req","state","dataWithDefaultValues","fields","locale","siblingData","user","addErrorPathToParent","parentPassesCondition","path"],"mappings":"AAQA,SAASA,sBAAsB,QAAQ,oCAAmC;AAC1E,SAASC,aAAa,QAAQ,qBAAoB;AAwBlD,OAAO,MAAMC,uBAAuB,OAAOC;IACzC,MAAM,EAAEC,EAAE,EAAEC,MAAMC,WAAW,CAAC,CAAC,EAAEC,WAAW,EAAEC,SAAS,EAAEC,WAAW,EAAEC,GAAG,EAAE,GAAGP;IAE9E,IAAII,aAAa;QACf,MAAMI,QAAmB,CAAC;QAE1B,MAAMC,wBAAwB,MAAMZ,uBAAuB;YACzDI;YACAC,MAAMC;YACNO,QAAQN;YACRO,QAAQJ,IAAII,MAAM;YAClBC,aAAaT;YACbU,MAAMN,IAAIM,IAAI;QAChB;QAEA,MAAMf,cAAc;YAClBG;YACAa,sBAAsB;YACtBZ,MAAMO;YACNC,QAAQN;YACRD;YACAE;YACAU,uBAAuB;YACvBC,MAAM;YACNV;YACAC;YACAC;QACF;QAEA,OAAOA;IACT;IAEA,OAAO,CAAC;AACV,EAAC;AAED,SAASV,aAAa,GAAE"}