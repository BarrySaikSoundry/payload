{"version":3,"sources":["../../../src/forms/RenderFields/RenderField.tsx"],"sourcesContent":["'use client'\n\nimport type { FieldPermissions, FieldTypes } from 'payload'\n\nimport React from 'react'\n\nimport type {\n  FieldComponentProps,\n  MappedField,\n} from '../../providers/ComponentMap/buildComponentMap/types.js'\n\nimport { HiddenField } from '../../fields/Hidden/index.js'\nimport { useFieldComponents } from '../../providers/FieldComponents/index.js'\nimport { useOperation } from '../../providers/Operation/index.js'\nimport { FieldPropsProvider, useFieldProps } from '../FieldPropsProvider/index.js'\n\ntype Props = {\n  CustomField: MappedField['CustomField']\n  custom?: Record<any, string>\n  disabled: boolean\n  fieldComponentProps?: FieldComponentProps\n  indexPath?: string\n  isHidden?: boolean\n  name?: string\n  path: string\n  permissions?: FieldPermissions\n  readOnly?: boolean\n  schemaPath: string\n  siblingPermissions: {\n    [fieldName: string]: FieldPermissions\n  }\n  type: keyof FieldTypes\n}\n\nexport const RenderField: React.FC<Props> = ({\n  name,\n  type,\n  CustomField,\n  custom,\n  disabled,\n  fieldComponentProps,\n  indexPath,\n  isHidden,\n  path: pathFromProps,\n  permissions,\n  readOnly: readOnlyFromProps,\n  schemaPath: schemaPathFromProps,\n  siblingPermissions,\n}) => {\n  const operation = useOperation()\n  const { readOnly: readOnlyFromContext } = useFieldProps()\n  const fieldComponents = useFieldComponents()\n\n  const path = [pathFromProps, name].filter(Boolean).join('.')\n  const schemaPath = [schemaPathFromProps, name].filter(Boolean).join('.')\n\n  // if the user cannot read the field, then filter it out\n  // this is different from `admin.readOnly` which is executed based on `operation`\n  if (permissions?.read?.permission === false || disabled) {\n    return null\n  }\n\n  // `admin.readOnly` displays the value but prevents the field from being edited\n  let readOnly = readOnlyFromProps\n\n  // if parent field is `readOnly: true`, but this field is `readOnly: false`, the field should still be editable\n  if (readOnlyFromContext && readOnly !== false) readOnly = true\n\n  // if the user does not have access control to begin with, force it to be read-only\n  if (permissions?.[operation]?.permission === false) {\n    readOnly = true\n  }\n\n  const DefaultField = isHidden ? HiddenField : fieldComponents[type]\n\n  if (CustomField === undefined && !DefaultField) {\n    return null\n  }\n\n  return (\n    <FieldPropsProvider\n      custom={custom}\n      indexPath={indexPath}\n      path={path}\n      permissions={permissions}\n      readOnly={readOnly}\n      schemaPath={schemaPath}\n      siblingPermissions={siblingPermissions}\n      type={type}\n    >\n      {CustomField !== undefined ? CustomField : <DefaultField {...fieldComponentProps} />}\n    </FieldPropsProvider>\n  )\n}\n"],"names":["React","HiddenField","useFieldComponents","useOperation","FieldPropsProvider","useFieldProps","RenderField","name","type","CustomField","custom","disabled","fieldComponentProps","indexPath","isHidden","path","pathFromProps","permissions","readOnly","readOnlyFromProps","schemaPath","schemaPathFromProps","siblingPermissions","operation","readOnlyFromContext","fieldComponents","filter","Boolean","join","read","permission","DefaultField","undefined"],"mappings":"AAAA;;AAIA,OAAOA,WAAW,QAAO;AAOzB,SAASC,WAAW,QAAQ,+BAA8B;AAC1D,SAASC,kBAAkB,QAAQ,2CAA0C;AAC7E,SAASC,YAAY,QAAQ,qCAAoC;AACjE,SAASC,kBAAkB,EAAEC,aAAa,QAAQ,iCAAgC;AAoBlF,OAAO,MAAMC,cAA+B,CAAC,EAC3CC,IAAI,EACJC,IAAI,EACJC,WAAW,EACXC,MAAM,EACNC,QAAQ,EACRC,mBAAmB,EACnBC,SAAS,EACTC,QAAQ,EACRC,MAAMC,aAAa,EACnBC,WAAW,EACXC,UAAUC,iBAAiB,EAC3BC,YAAYC,mBAAmB,EAC/BC,kBAAkB,EACnB;IACC,MAAMC,YAAYpB;IAClB,MAAM,EAAEe,UAAUM,mBAAmB,EAAE,GAAGnB;IAC1C,MAAMoB,kBAAkBvB;IAExB,MAAMa,OAAO;QAACC;QAAeT;KAAK,CAACmB,MAAM,CAACC,SAASC,IAAI,CAAC;IACxD,MAAMR,aAAa;QAACC;QAAqBd;KAAK,CAACmB,MAAM,CAACC,SAASC,IAAI,CAAC;IAEpE,wDAAwD;IACxD,iFAAiF;IACjF,IAAIX,aAAaY,MAAMC,eAAe,SAASnB,UAAU;QACvD,OAAO;IACT;IAEA,+EAA+E;IAC/E,IAAIO,WAAWC;IAEf,+GAA+G;IAC/G,IAAIK,uBAAuBN,aAAa,OAAOA,WAAW;IAE1D,mFAAmF;IACnF,IAAID,aAAa,CAACM,UAAU,EAAEO,eAAe,OAAO;QAClDZ,WAAW;IACb;IAEA,MAAMa,eAAejB,WAAWb,cAAcwB,eAAe,CAACjB,KAAK;IAEnE,IAAIC,gBAAgBuB,aAAa,CAACD,cAAc;QAC9C,OAAO;IACT;IAEA,qBACE,KAAC3B;QACCM,QAAQA;QACRG,WAAWA;QACXE,MAAMA;QACNE,aAAaA;QACbC,UAAUA;QACVE,YAAYA;QACZE,oBAAoBA;QACpBd,MAAMA;kBAELC,gBAAgBuB,YAAYvB,4BAAc,KAACsB;YAAc,GAAGnB,mBAAmB;;;AAGtF,EAAC"}