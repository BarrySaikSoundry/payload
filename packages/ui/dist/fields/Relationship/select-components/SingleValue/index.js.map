{"version":3,"sources":["../../../../../src/fields/Relationship/select-components/SingleValue/index.tsx"],"sourcesContent":["'use client'\nimport type { SingleValueProps } from 'react-select'\n\nimport React, { Fragment, useEffect, useState } from 'react'\nimport { components as SelectComponents } from 'react-select'\n\nimport type { Option } from '../../types.js'\n\nimport { useDocumentDrawer } from '../../../../elements/DocumentDrawer/index.js'\nimport { Tooltip } from '../../../../elements/Tooltip/index.js'\nimport { EditIcon } from '../../../../icons/Edit/index.js'\nimport { useAuth } from '../../../../providers/Auth/index.js'\nimport { useTranslation } from '../../../../providers/Translation/index.js'\nimport './index.scss'\n\nconst baseClass = 'relationship--single-value'\n\nexport const SingleValue: React.FC<SingleValueProps<Option>> = (props) => {\n  const {\n    children,\n    data: { label, relationTo, value },\n    // @ts-expect-error-next-line // TODO Fix this - moduleResolution 16 breaks our declare module\n    selectProps: { customProps: { onSave, setDrawerIsOpen } = {} } = {},\n  } = props\n\n  const [showTooltip, setShowTooltip] = useState(false)\n  const { t } = useTranslation()\n  const { permissions } = useAuth()\n  const hasReadPermission = Boolean(permissions?.collections?.[relationTo]?.read?.permission)\n\n  const [DocumentDrawer, DocumentDrawerToggler, { isDrawerOpen }] = useDocumentDrawer({\n    id: value.toString(),\n    collectionSlug: relationTo,\n  })\n\n  useEffect(() => {\n    if (typeof setDrawerIsOpen === 'function') {\n      setDrawerIsOpen(isDrawerOpen)\n    }\n  }, [isDrawerOpen, setDrawerIsOpen])\n\n  return (\n    <React.Fragment>\n      {/* @ts-expect-error // TODO Fix this - Broke with React 19 types */}\n      <SelectComponents.SingleValue {...props} className={baseClass}>\n        <div className={`${baseClass}__label`}>\n          <div className={`${baseClass}__label-text`}>\n            <div className={`${baseClass}__text`}>{children}</div>\n            {relationTo && hasReadPermission && (\n              <Fragment>\n                <DocumentDrawerToggler\n                  aria-label={t('general:editLabel', { label })}\n                  className={`${baseClass}__drawer-toggler`}\n                  onClick={() => setShowTooltip(false)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      e.stopPropagation()\n                    }\n                  }}\n                  onMouseDown={(e) => e.stopPropagation()} // prevents react-select dropdown from opening\n                  onMouseEnter={() => setShowTooltip(true)}\n                  onMouseLeave={() => setShowTooltip(false)}\n                  onTouchEnd={(e) => e.stopPropagation()} // prevents react-select dropdown from opening\n                >\n                  <Tooltip className={`${baseClass}__tooltip`} show={showTooltip}>\n                    {t('general:edit')}\n                  </Tooltip>\n                  <EditIcon />\n                </DocumentDrawerToggler>\n              </Fragment>\n            )}\n          </div>\n        </div>\n        {relationTo && hasReadPermission && <DocumentDrawer onSave={onSave} />}\n      </SelectComponents.SingleValue>\n    </React.Fragment>\n  )\n}\n"],"names":["React","Fragment","useEffect","useState","components","SelectComponents","useDocumentDrawer","Tooltip","EditIcon","useAuth","useTranslation","baseClass","SingleValue","props","children","data","label","relationTo","value","selectProps","customProps","onSave","setDrawerIsOpen","showTooltip","setShowTooltip","t","permissions","hasReadPermission","Boolean","collections","read","permission","DocumentDrawer","DocumentDrawerToggler","isDrawerOpen","id","toString","collectionSlug","className","div","aria-label","onClick","onKeyDown","e","key","stopPropagation","onMouseDown","onMouseEnter","onMouseLeave","onTouchEnd","show"],"mappings":"AAAA;;AAGA,OAAOA,SAASC,QAAQ,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,QAAO;AAC5D,SAASC,cAAcC,gBAAgB,QAAQ,eAAc;AAI7D,SAASC,iBAAiB,QAAQ,+CAA8C;AAChF,SAASC,OAAO,QAAQ,wCAAuC;AAC/D,SAASC,QAAQ,QAAQ,kCAAiC;AAC1D,SAASC,OAAO,QAAQ,sCAAqC;AAC7D,SAASC,cAAc,QAAQ,6CAA4C;AAC3E,OAAO,eAAc;AAErB,MAAMC,YAAY;AAElB,OAAO,MAAMC,cAAkD,CAACC;IAC9D,MAAM,EACJC,QAAQ,EACRC,MAAM,EAAEC,KAAK,EAAEC,UAAU,EAAEC,KAAK,EAAE,EAClC,8FAA8F;IAC9FC,aAAa,EAAEC,aAAa,EAAEC,MAAM,EAAEC,eAAe,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EACpE,GAAGT;IAEJ,MAAM,CAACU,aAAaC,eAAe,GAAGrB,SAAS;IAC/C,MAAM,EAAEsB,CAAC,EAAE,GAAGf;IACd,MAAM,EAAEgB,WAAW,EAAE,GAAGjB;IACxB,MAAMkB,oBAAoBC,QAAQF,aAAaG,aAAa,CAACZ,WAAW,EAAEa,MAAMC;IAEhF,MAAM,CAACC,gBAAgBC,uBAAuB,EAAEC,YAAY,EAAE,CAAC,GAAG5B,kBAAkB;QAClF6B,IAAIjB,MAAMkB,QAAQ;QAClBC,gBAAgBpB;IAClB;IAEAf,UAAU;QACR,IAAI,OAAOoB,oBAAoB,YAAY;YACzCA,gBAAgBY;QAClB;IACF,GAAG;QAACA;QAAcZ;KAAgB;IAElC,qBACE,KAACtB,MAAMC,QAAQ;kBAEb,cAAA,MAACI,iBAAiBO,WAAW;YAAE,GAAGC,KAAK;YAAEyB,WAAW3B;;8BAClD,KAAC4B;oBAAID,WAAW,CAAC,EAAE3B,UAAU,OAAO,CAAC;8BACnC,cAAA,MAAC4B;wBAAID,WAAW,CAAC,EAAE3B,UAAU,YAAY,CAAC;;0CACxC,KAAC4B;gCAAID,WAAW,CAAC,EAAE3B,UAAU,MAAM,CAAC;0CAAGG;;4BACtCG,cAAcU,mCACb,KAAC1B;0CACC,cAAA,MAACgC;oCACCO,cAAYf,EAAE,qBAAqB;wCAAET;oCAAM;oCAC3CsB,WAAW,CAAC,EAAE3B,UAAU,gBAAgB,CAAC;oCACzC8B,SAAS,IAAMjB,eAAe;oCAC9BkB,WAAW,CAACC;wCACV,IAAIA,EAAEC,GAAG,KAAK,SAAS;4CACrBD,EAAEE,eAAe;wCACnB;oCACF;oCACAC,aAAa,CAACH,IAAMA,EAAEE,eAAe;oCACrCE,cAAc,IAAMvB,eAAe;oCACnCwB,cAAc,IAAMxB,eAAe;oCACnCyB,YAAY,CAACN,IAAMA,EAAEE,eAAe;;sDAEpC,KAACtC;4CAAQ+B,WAAW,CAAC,EAAE3B,UAAU,SAAS,CAAC;4CAAEuC,MAAM3B;sDAChDE,EAAE;;sDAEL,KAACjB;;;;;;;gBAMVS,cAAcU,mCAAqB,KAACK;oBAAeX,QAAQA;;;;;AAIpE,EAAC"}