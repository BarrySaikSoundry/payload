{"version":3,"sources":["../../../../src/elements/Table/RelationshipProvider/reducer.ts"],"sourcesContent":["import type { TypeWithID } from 'payload'\n\nimport type { Documents } from './index.js'\n\ntype RequestDocuments = {\n  docs: { relationTo: string; value: number | string }[]\n  type: 'REQUEST'\n}\n\ntype AddLoadedDocuments = {\n  docs: TypeWithID[]\n  idsToLoad: (number | string)[]\n  relationTo: string\n  type: 'ADD_LOADED'\n}\n\ntype Action = AddLoadedDocuments | RequestDocuments\n\nexport function reducer(state: Documents, action: Action): Documents {\n  switch (action.type) {\n    case 'REQUEST': {\n      const newState = { ...state }\n\n      action.docs.forEach(({ relationTo, value }) => {\n        if (typeof newState[relationTo] !== 'object') {\n          newState[relationTo] = {}\n        }\n        newState[relationTo][value] = null\n      })\n\n      return newState\n    }\n\n    case 'ADD_LOADED': {\n      const newState = { ...state }\n      if (typeof newState[action.relationTo] !== 'object') {\n        newState[action.relationTo] = {}\n      }\n      const unreturnedIDs = [...action.idsToLoad]\n\n      if (Array.isArray(action.docs)) {\n        action.docs.forEach((doc) => {\n          unreturnedIDs.splice(unreturnedIDs.indexOf(doc.id), 1)\n          newState[action.relationTo][doc.id] = doc\n        })\n      }\n\n      unreturnedIDs.forEach((id) => {\n        newState[action.relationTo][id] = false\n      })\n\n      return newState\n    }\n\n    default: {\n      return state\n    }\n  }\n}\n"],"names":["reducer","state","action","type","newState","docs","forEach","relationTo","value","unreturnedIDs","idsToLoad","Array","isArray","doc","splice","indexOf","id"],"mappings":"AAkBA,OAAO,SAASA,QAAQC,KAAgB,EAAEC,MAAc;IACtD,OAAQA,OAAOC,IAAI;QACjB,KAAK;YAAW;gBACd,MAAMC,WAAW;oBAAE,GAAGH,KAAK;gBAAC;gBAE5BC,OAAOG,IAAI,CAACC,OAAO,CAAC,CAAC,EAAEC,UAAU,EAAEC,KAAK,EAAE;oBACxC,IAAI,OAAOJ,QAAQ,CAACG,WAAW,KAAK,UAAU;wBAC5CH,QAAQ,CAACG,WAAW,GAAG,CAAC;oBAC1B;oBACAH,QAAQ,CAACG,WAAW,CAACC,MAAM,GAAG;gBAChC;gBAEA,OAAOJ;YACT;QAEA,KAAK;YAAc;gBACjB,MAAMA,WAAW;oBAAE,GAAGH,KAAK;gBAAC;gBAC5B,IAAI,OAAOG,QAAQ,CAACF,OAAOK,UAAU,CAAC,KAAK,UAAU;oBACnDH,QAAQ,CAACF,OAAOK,UAAU,CAAC,GAAG,CAAC;gBACjC;gBACA,MAAME,gBAAgB;uBAAIP,OAAOQ,SAAS;iBAAC;gBAE3C,IAAIC,MAAMC,OAAO,CAACV,OAAOG,IAAI,GAAG;oBAC9BH,OAAOG,IAAI,CAACC,OAAO,CAAC,CAACO;wBACnBJ,cAAcK,MAAM,CAACL,cAAcM,OAAO,CAACF,IAAIG,EAAE,GAAG;wBACpDZ,QAAQ,CAACF,OAAOK,UAAU,CAAC,CAACM,IAAIG,EAAE,CAAC,GAAGH;oBACxC;gBACF;gBAEAJ,cAAcH,OAAO,CAAC,CAACU;oBACrBZ,QAAQ,CAACF,OAAOK,UAAU,CAAC,CAACS,GAAG,GAAG;gBACpC;gBAEA,OAAOZ;YACT;QAEA;YAAS;gBACP,OAAOH;YACT;IACF;AACF"}