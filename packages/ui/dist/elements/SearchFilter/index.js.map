{"version":3,"sources":["../../../src/elements/SearchFilter/index.tsx"],"sourcesContent":["'use client'\nimport { getTranslation } from '@payloadcms/translations'\n// TODO: abstract the `next/navigation` dependency out from this component\nimport { usePathname, useRouter } from 'next/navigation.js'\nimport React, { useEffect, useRef, useState } from 'react'\n\nexport type SearchFilterProps = {\n  fieldLabel?: string\n  fieldName?: string\n  handleChange?: (search: string) => void\n  listSearchableFields?: MappedField[]\n}\n\nimport type { MappedField } from '../../providers/ComponentMap/buildComponentMap/types.js'\n\nimport { useDebounce } from '../../hooks/useDebounce.js'\nimport { SearchIcon } from '../../icons/Search/index.js'\nimport { useSearchParams } from '../../providers/SearchParams/index.js'\nimport { useTranslation } from '../../providers/Translation/index.js'\nimport './index.scss'\n\nconst baseClass = 'search-filter'\n\nexport const SearchFilter: React.FC<SearchFilterProps> = (props) => {\n  const { fieldLabel = 'ID', fieldName = 'id', handleChange, listSearchableFields } = props\n\n  const { searchParams } = useSearchParams()\n  const router = useRouter()\n  const pathname = usePathname()\n  const { i18n, t } = useTranslation()\n\n  const [search, setSearch] = useState(\n    typeof searchParams?.search === 'string' ? searchParams?.search : '',\n  )\n  const [previousSearch, setPreviousSearch] = useState('')\n\n  const placeholder = useRef(t('general:searchBy', { label: getTranslation(fieldLabel, i18n) }))\n\n  const debouncedSearch = useDebounce(search, 300)\n\n  useEffect(() => {\n    if (debouncedSearch !== previousSearch) {\n      if (handleChange) handleChange(debouncedSearch)\n      setPreviousSearch(debouncedSearch)\n    }\n  }, [\n    debouncedSearch,\n    previousSearch,\n    router,\n    fieldName,\n    searchParams,\n    handleChange,\n    listSearchableFields,\n    pathname,\n  ])\n\n  useEffect(() => {\n    if (listSearchableFields?.length > 0) {\n      placeholder.current = listSearchableFields.reduce(\n        (placeholderText: string, field, i: number) => {\n          const label =\n            'fieldComponentProps' in field &&\n            'label' in field.fieldComponentProps &&\n            field.fieldComponentProps.label\n              ? field.fieldComponentProps.label\n              : field.name\n\n          if (i === 0) {\n            return `${t('general:searchBy', {\n              label: getTranslation(label, i18n),\n            })}`\n          }\n\n          if (i === listSearchableFields.length - 1) {\n            return `${placeholderText} ${t('general:or')} ${getTranslation(label, i18n)}`\n          }\n\n          return `${placeholderText}, ${getTranslation(label, i18n)}`\n        },\n        '',\n      )\n    } else {\n      placeholder.current = t('general:searchBy', { label: getTranslation(fieldLabel, i18n) })\n    }\n  }, [t, listSearchableFields, i18n, fieldLabel])\n\n  return (\n    <div className={baseClass}>\n      <input\n        className={`${baseClass}__input`}\n        onChange={(e) => setSearch(e.target.value)}\n        placeholder={placeholder.current}\n        type=\"text\"\n        value={search || ''}\n      />\n      <SearchIcon />\n    </div>\n  )\n}\n"],"names":["getTranslation","usePathname","useRouter","React","useEffect","useRef","useState","useDebounce","SearchIcon","useSearchParams","useTranslation","baseClass","SearchFilter","props","fieldLabel","fieldName","handleChange","listSearchableFields","searchParams","router","pathname","i18n","t","search","setSearch","previousSearch","setPreviousSearch","placeholder","label","debouncedSearch","length","current","reduce","placeholderText","field","i","fieldComponentProps","name","div","className","input","onChange","e","target","value","type"],"mappings":"AAAA;;AACA,SAASA,cAAc,QAAQ,2BAA0B;AACzD,0EAA0E;AAC1E,SAASC,WAAW,EAAEC,SAAS,QAAQ,qBAAoB;AAC3D,OAAOC,SAASC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,QAAO;AAW1D,SAASC,WAAW,QAAQ,6BAA4B;AACxD,SAASC,UAAU,QAAQ,8BAA6B;AACxD,SAASC,eAAe,QAAQ,wCAAuC;AACvE,SAASC,cAAc,QAAQ,uCAAsC;AACrE,OAAO,eAAc;AAErB,MAAMC,YAAY;AAElB,OAAO,MAAMC,eAA4C,CAACC;IACxD,MAAM,EAAEC,aAAa,IAAI,EAAEC,YAAY,IAAI,EAAEC,YAAY,EAAEC,oBAAoB,EAAE,GAAGJ;IAEpF,MAAM,EAAEK,YAAY,EAAE,GAAGT;IACzB,MAAMU,SAASjB;IACf,MAAMkB,WAAWnB;IACjB,MAAM,EAAEoB,IAAI,EAAEC,CAAC,EAAE,GAAGZ;IAEpB,MAAM,CAACa,QAAQC,UAAU,GAAGlB,SAC1B,OAAOY,cAAcK,WAAW,WAAWL,cAAcK,SAAS;IAEpE,MAAM,CAACE,gBAAgBC,kBAAkB,GAAGpB,SAAS;IAErD,MAAMqB,cAActB,OAAOiB,EAAE,oBAAoB;QAAEM,OAAO5B,eAAec,YAAYO;IAAM;IAE3F,MAAMQ,kBAAkBtB,YAAYgB,QAAQ;IAE5CnB,UAAU;QACR,IAAIyB,oBAAoBJ,gBAAgB;YACtC,IAAIT,cAAcA,aAAaa;YAC/BH,kBAAkBG;QACpB;IACF,GAAG;QACDA;QACAJ;QACAN;QACAJ;QACAG;QACAF;QACAC;QACAG;KACD;IAEDhB,UAAU;QACR,IAAIa,sBAAsBa,SAAS,GAAG;YACpCH,YAAYI,OAAO,GAAGd,qBAAqBe,MAAM,CAC/C,CAACC,iBAAyBC,OAAOC;gBAC/B,MAAMP,QACJ,yBAAyBM,SACzB,WAAWA,MAAME,mBAAmB,IACpCF,MAAME,mBAAmB,CAACR,KAAK,GAC3BM,MAAME,mBAAmB,CAACR,KAAK,GAC/BM,MAAMG,IAAI;gBAEhB,IAAIF,MAAM,GAAG;oBACX,OAAO,CAAC,EAAEb,EAAE,oBAAoB;wBAC9BM,OAAO5B,eAAe4B,OAAOP;oBAC/B,GAAG,CAAC;gBACN;gBAEA,IAAIc,MAAMlB,qBAAqBa,MAAM,GAAG,GAAG;oBACzC,OAAO,CAAC,EAAEG,gBAAgB,CAAC,EAAEX,EAAE,cAAc,CAAC,EAAEtB,eAAe4B,OAAOP,MAAM,CAAC;gBAC/E;gBAEA,OAAO,CAAC,EAAEY,gBAAgB,EAAE,EAAEjC,eAAe4B,OAAOP,MAAM,CAAC;YAC7D,GACA;QAEJ,OAAO;YACLM,YAAYI,OAAO,GAAGT,EAAE,oBAAoB;gBAAEM,OAAO5B,eAAec,YAAYO;YAAM;QACxF;IACF,GAAG;QAACC;QAAGL;QAAsBI;QAAMP;KAAW;IAE9C,qBACE,MAACwB;QAAIC,WAAW5B;;0BACd,KAAC6B;gBACCD,WAAW,CAAC,EAAE5B,UAAU,OAAO,CAAC;gBAChC8B,UAAU,CAACC,IAAMlB,UAAUkB,EAAEC,MAAM,CAACC,KAAK;gBACzCjB,aAAaA,YAAYI,OAAO;gBAChCc,MAAK;gBACLD,OAAOrB,UAAU;;0BAEnB,KAACf;;;AAGP,EAAC"}