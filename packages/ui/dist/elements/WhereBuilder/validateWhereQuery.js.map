{"version":3,"sources":["../../../src/elements/WhereBuilder/validateWhereQuery.ts"],"sourcesContent":["import type { Operator, Where } from 'payload'\n\nimport { validOperators } from 'payload/shared'\n\nconst validateWhereQuery = (whereQuery): whereQuery is Where => {\n  if (\n    whereQuery?.or?.length > 0 &&\n    whereQuery?.or?.[0]?.and &&\n    whereQuery?.or?.[0]?.and?.length > 0\n  ) {\n    // At this point we know that the whereQuery has 'or' and 'and' fields,\n    // now let's check the structure and content of these fields.\n\n    const isValid = whereQuery.or.every((orQuery) => {\n      if (orQuery.and && Array.isArray(orQuery.and)) {\n        return orQuery.and.every((andQuery) => {\n          if (typeof andQuery !== 'object') {\n            return false\n          }\n          const andKeys = Object.keys(andQuery)\n          // If there are no keys, it's not a valid WhereField.\n          if (andKeys.length === 0) {\n            return false\n          }\n\n          for (const key of andKeys) {\n            const operator = Object.keys(andQuery[key])[0]\n            // Check if the key is a valid Operator.\n            if (!operator || !validOperators.includes(operator as Operator)) {\n              return false\n            }\n          }\n          return true\n        })\n      }\n      return false\n    })\n\n    return isValid\n  }\n\n  return false\n}\n\nexport default validateWhereQuery\n"],"names":["validOperators","validateWhereQuery","whereQuery","or","length","and","isValid","every","orQuery","Array","isArray","andQuery","andKeys","Object","keys","key","operator","includes"],"mappings":"AAEA,SAASA,cAAc,QAAQ,iBAAgB;AAE/C,MAAMC,qBAAqB,CAACC;IAC1B,IACEA,YAAYC,IAAIC,SAAS,KACzBF,YAAYC,IAAI,CAAC,EAAE,EAAEE,OACrBH,YAAYC,IAAI,CAAC,EAAE,EAAEE,KAAKD,SAAS,GACnC;QACA,uEAAuE;QACvE,6DAA6D;QAE7D,MAAME,UAAUJ,WAAWC,EAAE,CAACI,KAAK,CAAC,CAACC;YACnC,IAAIA,QAAQH,GAAG,IAAII,MAAMC,OAAO,CAACF,QAAQH,GAAG,GAAG;gBAC7C,OAAOG,QAAQH,GAAG,CAACE,KAAK,CAAC,CAACI;oBACxB,IAAI,OAAOA,aAAa,UAAU;wBAChC,OAAO;oBACT;oBACA,MAAMC,UAAUC,OAAOC,IAAI,CAACH;oBAC5B,qDAAqD;oBACrD,IAAIC,QAAQR,MAAM,KAAK,GAAG;wBACxB,OAAO;oBACT;oBAEA,KAAK,MAAMW,OAAOH,QAAS;wBACzB,MAAMI,WAAWH,OAAOC,IAAI,CAACH,QAAQ,CAACI,IAAI,CAAC,CAAC,EAAE;wBAC9C,wCAAwC;wBACxC,IAAI,CAACC,YAAY,CAAChB,eAAeiB,QAAQ,CAACD,WAAuB;4BAC/D,OAAO;wBACT;oBACF;oBACA,OAAO;gBACT;YACF;YACA,OAAO;QACT;QAEA,OAAOV;IACT;IAEA,OAAO;AACT;AAEA,eAAeL,mBAAkB"}