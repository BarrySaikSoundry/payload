{"version":3,"sources":["../../src/Search/index.ts"],"sourcesContent":["import type { CollectionConfig, Field } from 'payload'\n\nimport deepMerge from 'deepmerge'\n\nimport type { SearchPluginConfig } from '../types.js'\n\nimport { LinkToDoc } from './ui/index.js'\n\n// all settings can be overridden by the config\nexport const generateSearchCollection = (pluginConfig: SearchPluginConfig): CollectionConfig => {\n  const defaultFields: Field[] = [\n    {\n      name: 'title',\n      type: 'text',\n      admin: {\n        readOnly: true,\n      },\n    },\n    {\n      name: 'priority',\n      type: 'number',\n      admin: {\n        position: 'sidebar',\n      },\n    },\n    {\n      name: 'doc',\n      type: 'relationship',\n      admin: {\n        position: 'sidebar',\n        readOnly: true,\n      },\n      index: true,\n      maxDepth: 0,\n      relationTo: pluginConfig?.collections || [],\n      required: true,\n    },\n    {\n      name: 'docUrl',\n      type: 'ui',\n      admin: {\n        components: {\n          Field: LinkToDoc,\n        },\n        position: 'sidebar',\n      },\n    },\n  ]\n\n  const newConfig: CollectionConfig = {\n    ...(pluginConfig?.searchOverrides || {}),\n    slug: pluginConfig?.searchOverrides?.slug || 'search',\n    access: {\n      create: (): boolean => false,\n      read: (): boolean => true,\n      ...(pluginConfig?.searchOverrides?.access || {}),\n    },\n    admin: {\n      defaultColumns: ['title'],\n      description:\n        'This is a collection of automatically created search results. These results are used by the global site search and will be updated automatically as documents in the CMS are created or updated.',\n      enableRichTextRelationship: false,\n      useAsTitle: 'title',\n      ...(pluginConfig?.searchOverrides?.admin || {}),\n    },\n    fields:\n      pluginConfig?.searchOverrides?.fields &&\n      typeof pluginConfig?.searchOverrides?.fields === 'function'\n        ? pluginConfig?.searchOverrides.fields({ defaultFields })\n        : defaultFields,\n    hooks: {\n      ...(pluginConfig?.searchOverrides?.hooks || {}),\n    },\n    labels: {\n      plural: 'Search Results',\n      singular: 'Search Result',\n    },\n  }\n\n  return newConfig\n}\n"],"names":["LinkToDoc","generateSearchCollection","pluginConfig","defaultFields","name","type","admin","readOnly","position","index","maxDepth","relationTo","collections","required","components","Field","newConfig","searchOverrides","slug","access","create","read","defaultColumns","description","enableRichTextRelationship","useAsTitle","fields","hooks","labels","plural","singular"],"mappings":"AAMA,SAASA,SAAS,QAAQ,gBAAe;AAEzC,+CAA+C;AAC/C,OAAO,MAAMC,2BAA2B,CAACC;IACvC,MAAMC,gBAAyB;QAC7B;YACEC,MAAM;YACNC,MAAM;YACNC,OAAO;gBACLC,UAAU;YACZ;QACF;QACA;YACEH,MAAM;YACNC,MAAM;YACNC,OAAO;gBACLE,UAAU;YACZ;QACF;QACA;YACEJ,MAAM;YACNC,MAAM;YACNC,OAAO;gBACLE,UAAU;gBACVD,UAAU;YACZ;YACAE,OAAO;YACPC,UAAU;YACVC,YAAYT,cAAcU,eAAe,EAAE;YAC3CC,UAAU;QACZ;QACA;YACET,MAAM;YACNC,MAAM;YACNC,OAAO;gBACLQ,YAAY;oBACVC,OAAOf;gBACT;gBACAQ,UAAU;YACZ;QACF;KACD;IAED,MAAMQ,YAA8B;QAClC,GAAId,cAAce,mBAAmB,CAAC,CAAC;QACvCC,MAAMhB,cAAce,iBAAiBC,QAAQ;QAC7CC,QAAQ;YACNC,QAAQ,IAAe;YACvBC,MAAM,IAAe;YACrB,GAAInB,cAAce,iBAAiBE,UAAU,CAAC,CAAC;QACjD;QACAb,OAAO;YACLgB,gBAAgB;gBAAC;aAAQ;YACzBC,aACE;YACFC,4BAA4B;YAC5BC,YAAY;YACZ,GAAIvB,cAAce,iBAAiBX,SAAS,CAAC,CAAC;QAChD;QACAoB,QACExB,cAAce,iBAAiBS,UAC/B,OAAOxB,cAAce,iBAAiBS,WAAW,aAC7CxB,cAAce,gBAAgBS,OAAO;YAAEvB;QAAc,KACrDA;QACNwB,OAAO;YACL,GAAIzB,cAAce,iBAAiBU,SAAS,CAAC,CAAC;QAChD;QACAC,QAAQ;YACNC,QAAQ;YACRC,UAAU;QACZ;IACF;IAEA,OAAOd;AACT,EAAC"}