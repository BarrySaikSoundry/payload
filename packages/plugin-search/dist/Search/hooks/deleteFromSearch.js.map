{"version":3,"sources":["../../../src/Search/hooks/deleteFromSearch.ts"],"sourcesContent":["import type { CollectionAfterDeleteHook } from 'payload'\n\nexport const deleteFromSearch: CollectionAfterDeleteHook = async ({\n  doc,\n  req: { payload },\n  req,\n}) => {\n  try {\n    const searchDocQuery = await payload.find({\n      collection: 'search',\n      depth: 0,\n      req,\n      where: {\n        'doc.value': {\n          equals: doc.id,\n        },\n      },\n    })\n\n    if (searchDocQuery?.docs?.[0]) {\n      await payload.delete({\n        id: searchDocQuery?.docs?.[0]?.id,\n        collection: 'search',\n        req,\n      })\n    }\n  } catch (err: unknown) {\n    payload.logger.error({\n      err: `Error deleting search doc: ${err}`,\n    })\n  }\n\n  return doc\n}\n"],"names":["deleteFromSearch","doc","req","payload","searchDocQuery","find","collection","depth","where","equals","id","docs","delete","err","logger","error"],"mappings":"AAEA,OAAO,MAAMA,mBAA8C,OAAO,EAChEC,GAAG,EACHC,KAAK,EAAEC,OAAO,EAAE,EAChBD,GAAG,EACJ;IACC,IAAI;QACF,MAAME,iBAAiB,MAAMD,QAAQE,IAAI,CAAC;YACxCC,YAAY;YACZC,OAAO;YACPL;YACAM,OAAO;gBACL,aAAa;oBACXC,QAAQR,IAAIS,EAAE;gBAChB;YACF;QACF;QAEA,IAAIN,gBAAgBO,MAAM,CAAC,EAAE,EAAE;YAC7B,MAAMR,QAAQS,MAAM,CAAC;gBACnBF,IAAIN,gBAAgBO,MAAM,CAAC,EAAE,EAAED;gBAC/BJ,YAAY;gBACZJ;YACF;QACF;IACF,EAAE,OAAOW,KAAc;QACrBV,QAAQW,MAAM,CAACC,KAAK,CAAC;YACnBF,KAAK,CAAC,2BAA2B,EAAEA,IAAI,CAAC;QAC1C;IACF;IAEA,OAAOZ;AACT,EAAC"}