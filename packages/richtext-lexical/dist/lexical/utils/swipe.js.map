{"version":3,"sources":["../../../src/lexical/utils/swipe.ts"],"sourcesContent":["type Force = [number, number]\ntype Listener = (force: Force, e: TouchEvent) => void\ninterface ElementValues {\n  handleTouchend: (e: TouchEvent) => void\n  handleTouchstart: (e: TouchEvent) => void\n  listeners: Set<Listener>\n  start: Force | null\n}\n\nconst elements = new WeakMap<HTMLElement, ElementValues>()\n\nfunction readTouch(e: TouchEvent): [number, number] | null {\n  const touch = e.changedTouches[0]\n  if (touch === undefined) {\n    return null\n  }\n  return [touch.clientX, touch.clientY]\n}\n\nfunction addListener(element: HTMLElement, cb: Listener): () => void {\n  let elementValues = elements.get(element)\n  if (elementValues === undefined) {\n    const listeners = new Set<Listener>()\n    const handleTouchstart = (e: TouchEvent): void => {\n      if (elementValues !== undefined) {\n        elementValues.start = readTouch(e)\n      }\n    }\n    const handleTouchend = (e: TouchEvent): void => {\n      if (elementValues === undefined) {\n        return\n      }\n      const { start } = elementValues\n      if (start === null) {\n        return\n      }\n      const end = readTouch(e)\n      for (const listener of listeners) {\n        if (end !== null) {\n          listener([end[0] - start[0], end[1] - start[1]], e)\n        }\n      }\n    }\n    element.addEventListener('touchstart', handleTouchstart)\n    element.addEventListener('touchend', handleTouchend)\n\n    elementValues = {\n      handleTouchend,\n      handleTouchstart,\n      listeners,\n      start: null,\n    }\n    elements.set(element, elementValues)\n  }\n  elementValues.listeners.add(cb)\n  return () => {\n    deleteListener(element, cb)\n  }\n}\n\nfunction deleteListener(element: HTMLElement, cb: Listener): void {\n  const elementValues = elements.get(element)\n  if (elementValues === undefined) {\n    return\n  }\n  const { listeners } = elementValues\n  listeners.delete(cb)\n  if (listeners.size === 0) {\n    elements.delete(element)\n    element.removeEventListener('touchstart', elementValues.handleTouchstart)\n    element.removeEventListener('touchend', elementValues.handleTouchend)\n  }\n}\n\nexport function addSwipeLeftListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n): () => void {\n  return addListener(element, (force, e) => {\n    const [x, y] = force\n    if (x < 0 && -x > Math.abs(y)) {\n      cb(x, e)\n    }\n  })\n}\n\nexport function addSwipeRightListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n): () => void {\n  return addListener(element, (force, e) => {\n    const [x, y] = force\n    if (x > 0 && x > Math.abs(y)) {\n      cb(x, e)\n    }\n  })\n}\n\nexport function addSwipeUpListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n): () => void {\n  return addListener(element, (force, e) => {\n    const [x, y] = force\n    if (y < 0 && -y > Math.abs(x)) {\n      cb(x, e)\n    }\n  })\n}\n\nexport function addSwipeDownListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n): () => void {\n  return addListener(element, (force, e) => {\n    const [x, y] = force\n    if (y > 0 && y > Math.abs(x)) {\n      cb(x, e)\n    }\n  })\n}\n"],"names":["elements","WeakMap","readTouch","e","touch","changedTouches","undefined","clientX","clientY","addListener","element","cb","elementValues","get","listeners","Set","handleTouchstart","start","handleTouchend","end","listener","addEventListener","set","add","deleteListener","delete","size","removeEventListener","addSwipeLeftListener","force","x","y","Math","abs","addSwipeRightListener","addSwipeUpListener","addSwipeDownListener"],"mappings":"AASA,MAAMA,WAAW,IAAIC;AAErB,SAASC,UAAUC,CAAa;IAC9B,MAAMC,QAAQD,EAAEE,cAAc,CAAC,EAAE;IACjC,IAAID,UAAUE,WAAW;QACvB,OAAO;IACT;IACA,OAAO;QAACF,MAAMG,OAAO;QAAEH,MAAMI,OAAO;KAAC;AACvC;AAEA,SAASC,YAAYC,OAAoB,EAAEC,EAAY;IACrD,IAAIC,gBAAgBZ,SAASa,GAAG,CAACH;IACjC,IAAIE,kBAAkBN,WAAW;QAC/B,MAAMQ,YAAY,IAAIC;QACtB,MAAMC,mBAAmB,CAACb;YACxB,IAAIS,kBAAkBN,WAAW;gBAC/BM,cAAcK,KAAK,GAAGf,UAAUC;YAClC;QACF;QACA,MAAMe,iBAAiB,CAACf;YACtB,IAAIS,kBAAkBN,WAAW;gBAC/B;YACF;YACA,MAAM,EAAEW,KAAK,EAAE,GAAGL;YAClB,IAAIK,UAAU,MAAM;gBAClB;YACF;YACA,MAAME,MAAMjB,UAAUC;YACtB,KAAK,MAAMiB,YAAYN,UAAW;gBAChC,IAAIK,QAAQ,MAAM;oBAChBC,SAAS;wBAACD,GAAG,CAAC,EAAE,GAAGF,KAAK,CAAC,EAAE;wBAAEE,GAAG,CAAC,EAAE,GAAGF,KAAK,CAAC,EAAE;qBAAC,EAAEd;gBACnD;YACF;QACF;QACAO,QAAQW,gBAAgB,CAAC,cAAcL;QACvCN,QAAQW,gBAAgB,CAAC,YAAYH;QAErCN,gBAAgB;YACdM;YACAF;YACAF;YACAG,OAAO;QACT;QACAjB,SAASsB,GAAG,CAACZ,SAASE;IACxB;IACAA,cAAcE,SAAS,CAACS,GAAG,CAACZ;IAC5B,OAAO;QACLa,eAAed,SAASC;IAC1B;AACF;AAEA,SAASa,eAAed,OAAoB,EAAEC,EAAY;IACxD,MAAMC,gBAAgBZ,SAASa,GAAG,CAACH;IACnC,IAAIE,kBAAkBN,WAAW;QAC/B;IACF;IACA,MAAM,EAAEQ,SAAS,EAAE,GAAGF;IACtBE,UAAUW,MAAM,CAACd;IACjB,IAAIG,UAAUY,IAAI,KAAK,GAAG;QACxB1B,SAASyB,MAAM,CAACf;QAChBA,QAAQiB,mBAAmB,CAAC,cAAcf,cAAcI,gBAAgB;QACxEN,QAAQiB,mBAAmB,CAAC,YAAYf,cAAcM,cAAc;IACtE;AACF;AAEA,OAAO,SAASU,qBACdlB,OAAoB,EACpBC,EAA2C;IAE3C,OAAOF,YAAYC,SAAS,CAACmB,OAAO1B;QAClC,MAAM,CAAC2B,GAAGC,EAAE,GAAGF;QACf,IAAIC,IAAI,KAAK,CAACA,IAAIE,KAAKC,GAAG,CAACF,IAAI;YAC7BpB,GAAGmB,GAAG3B;QACR;IACF;AACF;AAEA,OAAO,SAAS+B,sBACdxB,OAAoB,EACpBC,EAA2C;IAE3C,OAAOF,YAAYC,SAAS,CAACmB,OAAO1B;QAClC,MAAM,CAAC2B,GAAGC,EAAE,GAAGF;QACf,IAAIC,IAAI,KAAKA,IAAIE,KAAKC,GAAG,CAACF,IAAI;YAC5BpB,GAAGmB,GAAG3B;QACR;IACF;AACF;AAEA,OAAO,SAASgC,mBACdzB,OAAoB,EACpBC,EAA2C;IAE3C,OAAOF,YAAYC,SAAS,CAACmB,OAAO1B;QAClC,MAAM,CAAC2B,GAAGC,EAAE,GAAGF;QACf,IAAIE,IAAI,KAAK,CAACA,IAAIC,KAAKC,GAAG,CAACH,IAAI;YAC7BnB,GAAGmB,GAAG3B;QACR;IACF;AACF;AAEA,OAAO,SAASiC,qBACd1B,OAAoB,EACpBC,EAA2C;IAE3C,OAAOF,YAAYC,SAAS,CAACmB,OAAO1B;QAClC,MAAM,CAAC2B,GAAGC,EAAE,GAAGF;QACf,IAAIE,IAAI,KAAKA,IAAIC,KAAKC,GAAG,CAACH,IAAI;YAC5BnB,GAAGmB,GAAG3B;QACR;IACF;AACF"}