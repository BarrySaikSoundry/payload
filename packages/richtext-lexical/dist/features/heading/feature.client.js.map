{"version":3,"sources":["../../../src/features/heading/feature.client.tsx"],"sourcesContent":["'use client'\n\nimport type { HeadingTagType } from '@lexical/rich-text'\n\nimport { $createHeadingNode, $isHeadingNode, HeadingNode } from '@lexical/rich-text'\nimport { $setBlocksType } from '@lexical/selection'\nimport { $getSelection, $isRangeSelection } from 'lexical'\n\nimport type { ToolbarGroup } from '../toolbars/types.js'\nimport type { HeadingFeatureProps } from './feature.server.js'\n\nimport { H1Icon } from '../../lexical/ui/icons/H1/index.js'\nimport { H2Icon } from '../../lexical/ui/icons/H2/index.js'\nimport { H3Icon } from '../../lexical/ui/icons/H3/index.js'\nimport { H4Icon } from '../../lexical/ui/icons/H4/index.js'\nimport { H5Icon } from '../../lexical/ui/icons/H5/index.js'\nimport { H6Icon } from '../../lexical/ui/icons/H6/index.js'\nimport { createClientFeature } from '../../utilities/createClientFeature.js'\nimport { slashMenuBasicGroupWithItems } from '../shared/slashMenu/basicGroup.js'\nimport { toolbarTextDropdownGroupWithItems } from '../shared/toolbar/textDropdownGroup.js'\nimport { MarkdownTransformer } from './markdownTransformer.js'\n\nconst $setHeading = (headingSize: HeadingTagType) => {\n  const selection = $getSelection()\n  $setBlocksType(selection, () => $createHeadingNode(headingSize))\n}\n\nconst iconImports = {\n  h1: H1Icon,\n  h2: H2Icon,\n  h3: H3Icon,\n  h4: H4Icon,\n  h5: H5Icon,\n  h6: H6Icon,\n}\n\nexport const HeadingFeatureClient = createClientFeature<HeadingFeatureProps>(({ props }) => {\n  const { enabledHeadingSizes = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'] } = props\n\n  const toolbarGroups: ToolbarGroup[] = [\n    toolbarTextDropdownGroupWithItems(\n      enabledHeadingSizes.map((headingSize, i) => {\n        return {\n          ChildComponent: iconImports[headingSize],\n          isActive: ({ selection }) => {\n            if (!$isRangeSelection(selection)) {\n              return false\n            }\n            for (const node of selection.getNodes()) {\n              if ($isHeadingNode(node) && node.getTag() === headingSize) {\n                continue\n              }\n\n              const parent = node.getParent()\n              if ($isHeadingNode(parent) && parent.getTag() === headingSize) {\n                continue\n              }\n\n              return false\n            }\n            return true\n          },\n          key: headingSize,\n          label: ({ i18n }) => {\n            return i18n.t('lexical:heading:label', { headingLevel: headingSize.charAt(1) })\n          },\n          onSelect: ({ editor }) => {\n            editor.update(() => {\n              $setHeading(headingSize)\n            })\n          },\n          order: i + 2,\n        }\n      }),\n    ),\n  ]\n\n  return {\n    markdownTransformers: [MarkdownTransformer(enabledHeadingSizes)],\n    nodes: [HeadingNode],\n    sanitizedClientFeatureProps: props,\n    slashMenu: {\n      groups: enabledHeadingSizes?.length\n        ? [\n            slashMenuBasicGroupWithItems(\n              enabledHeadingSizes.map((headingSize) => {\n                return {\n                  Icon: iconImports[headingSize],\n                  key: `heading-${headingSize.charAt(1)}`,\n                  keywords: ['heading', headingSize],\n                  label: ({ i18n }) => {\n                    return i18n.t('lexical:heading:label', {\n                      headingLevel: headingSize.charAt(1),\n                    })\n                  },\n                  onSelect: ({ editor }) => {\n                    editor.update(() => {\n                      $setHeading(headingSize)\n                    })\n                  },\n                }\n              }),\n            ),\n          ]\n        : [],\n    },\n    toolbarFixed: {\n      groups: enabledHeadingSizes?.length ? toolbarGroups : [],\n    },\n    toolbarInline: {\n      groups: enabledHeadingSizes?.length ? toolbarGroups : [],\n    },\n  }\n})\n"],"names":["$createHeadingNode","$isHeadingNode","HeadingNode","$setBlocksType","$getSelection","$isRangeSelection","H1Icon","H2Icon","H3Icon","H4Icon","H5Icon","H6Icon","createClientFeature","slashMenuBasicGroupWithItems","toolbarTextDropdownGroupWithItems","MarkdownTransformer","$setHeading","headingSize","selection","iconImports","h1","h2","h3","h4","h5","h6","HeadingFeatureClient","props","enabledHeadingSizes","toolbarGroups","map","i","ChildComponent","isActive","node","getNodes","getTag","parent","getParent","key","label","i18n","t","headingLevel","charAt","onSelect","editor","update","order","markdownTransformers","nodes","sanitizedClientFeatureProps","slashMenu","groups","length","Icon","keywords","toolbarFixed","toolbarInline"],"mappings":"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"}