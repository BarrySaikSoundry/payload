{"version":3,"sources":["../../../src/features/blocks/feature.client.tsx"],"sourcesContent":["'use client'\n\nimport type { ReducedBlock } from '@payloadcms/ui/utilities/buildComponentMap'\n\nimport { getTranslation } from '@payloadcms/translations'\n\nimport { BlockIcon } from '../../lexical/ui/icons/Block/index.js'\nimport { createClientFeature } from '../../utilities/createClientFeature.js'\nimport { BlockNode } from './nodes/BlocksNode.js'\nimport { INSERT_BLOCK_COMMAND } from './plugin/commands.js'\nimport { BlocksPlugin } from './plugin/index.js'\n\nexport type BlocksFeatureClientProps = {\n  reducedBlocks: ReducedBlock[]\n}\n\nexport const BlocksFeatureClient = createClientFeature<BlocksFeatureClientProps>(({ props }) => ({\n  nodes: [BlockNode],\n  plugins: [\n    {\n      Component: BlocksPlugin,\n      position: 'normal',\n    },\n  ],\n  sanitizedClientFeatureProps: props,\n  slashMenu: {\n    groups: [\n      {\n        items: props.reducedBlocks.map((block) => {\n          return {\n            Icon: BlockIcon,\n            key: 'block-' + block.slug,\n            keywords: ['block', 'blocks', block.slug],\n            label: ({ i18n }) => {\n              if (!block.labels.singular) {\n                return block.slug\n              }\n\n              return getTranslation(block.labels.singular, i18n)\n            },\n            onSelect: ({ editor }) => {\n              editor.dispatchCommand(INSERT_BLOCK_COMMAND, {\n                id: null,\n                blockName: '',\n                blockType: block.slug,\n              })\n            },\n          }\n        }),\n        key: 'blocks',\n        label: ({ i18n }) => {\n          return i18n.t('lexical:blocks:label')\n        },\n      },\n    ],\n  },\n  toolbarFixed: {\n    groups: [\n      {\n        type: 'dropdown',\n        ChildComponent: BlockIcon,\n        items: props.reducedBlocks.map((block, index) => {\n          return {\n            ChildComponent: BlockIcon,\n            isActive: undefined, // At this point, we would be inside a sub-richtext-editor. And at this point this will be run against the focused sub-editor, not the parent editor which has the actual block. Thus, no point in running this\n            key: 'block-' + block.slug,\n            label: ({ i18n }) => {\n              if (!block.labels.singular) {\n                return block.slug\n              }\n\n              return getTranslation(block.labels.singular, i18n)\n            },\n            onSelect: ({ editor }) => {\n              editor.dispatchCommand(INSERT_BLOCK_COMMAND, {\n                id: null,\n                blockName: '',\n                blockType: block.slug,\n              })\n            },\n            order: index,\n          }\n        }),\n        key: 'blocks',\n        order: 20,\n      },\n    ],\n  },\n}))\n"],"names":["getTranslation","BlockIcon","createClientFeature","BlockNode","INSERT_BLOCK_COMMAND","BlocksPlugin","BlocksFeatureClient","props","nodes","plugins","Component","position","sanitizedClientFeatureProps","slashMenu","groups","items","reducedBlocks","map","block","Icon","key","slug","keywords","label","i18n","labels","singular","onSelect","editor","dispatchCommand","id","blockName","blockType","t","toolbarFixed","type","ChildComponent","index","isActive","undefined","order"],"mappings":"AAAA;AAIA,SAASA,cAAc,QAAQ,2BAA0B;AAEzD,SAASC,SAAS,QAAQ,wCAAuC;AACjE,SAASC,mBAAmB,QAAQ,yCAAwC;AAC5E,SAASC,SAAS,QAAQ,wBAAuB;AACjD,SAASC,oBAAoB,QAAQ,uBAAsB;AAC3D,SAASC,YAAY,QAAQ,oBAAmB;AAMhD,OAAO,MAAMC,sBAAsBJ,oBAA8C,CAAC,EAAEK,KAAK,EAAE,GAAM,CAAA;QAC/FC,OAAO;YAACL;SAAU;QAClBM,SAAS;YACP;gBACEC,WAAWL;gBACXM,UAAU;YACZ;SACD;QACDC,6BAA6BL;QAC7BM,WAAW;YACTC,QAAQ;gBACN;oBACEC,OAAOR,MAAMS,aAAa,CAACC,GAAG,CAAC,CAACC;wBAC9B,OAAO;4BACLC,MAAMlB;4BACNmB,KAAK,WAAWF,MAAMG,IAAI;4BAC1BC,UAAU;gCAAC;gCAAS;gCAAUJ,MAAMG,IAAI;6BAAC;4BACzCE,OAAO,CAAC,EAAEC,IAAI,EAAE;gCACd,IAAI,CAACN,MAAMO,MAAM,CAACC,QAAQ,EAAE;oCAC1B,OAAOR,MAAMG,IAAI;gCACnB;gCAEA,OAAOrB,eAAekB,MAAMO,MAAM,CAACC,QAAQ,EAAEF;4BAC/C;4BACAG,UAAU,CAAC,EAAEC,MAAM,EAAE;gCACnBA,OAAOC,eAAe,CAACzB,sBAAsB;oCAC3C0B,IAAI;oCACJC,WAAW;oCACXC,WAAWd,MAAMG,IAAI;gCACvB;4BACF;wBACF;oBACF;oBACAD,KAAK;oBACLG,OAAO,CAAC,EAAEC,IAAI,EAAE;wBACd,OAAOA,KAAKS,CAAC,CAAC;oBAChB;gBACF;aACD;QACH;QACAC,cAAc;YACZpB,QAAQ;gBACN;oBACEqB,MAAM;oBACNC,gBAAgBnC;oBAChBc,OAAOR,MAAMS,aAAa,CAACC,GAAG,CAAC,CAACC,OAAOmB;wBACrC,OAAO;4BACLD,gBAAgBnC;4BAChBqC,UAAUC;4BACVnB,KAAK,WAAWF,MAAMG,IAAI;4BAC1BE,OAAO,CAAC,EAAEC,IAAI,EAAE;gCACd,IAAI,CAACN,MAAMO,MAAM,CAACC,QAAQ,EAAE;oCAC1B,OAAOR,MAAMG,IAAI;gCACnB;gCAEA,OAAOrB,eAAekB,MAAMO,MAAM,CAACC,QAAQ,EAAEF;4BAC/C;4BACAG,UAAU,CAAC,EAAEC,MAAM,EAAE;gCACnBA,OAAOC,eAAe,CAACzB,sBAAsB;oCAC3C0B,IAAI;oCACJC,WAAW;oCACXC,WAAWd,MAAMG,IAAI;gCACvB;4BACF;4BACAmB,OAAOH;wBACT;oBACF;oBACAjB,KAAK;oBACLoB,OAAO;gBACT;aACD;QACH;IACF,CAAA,GAAG"}