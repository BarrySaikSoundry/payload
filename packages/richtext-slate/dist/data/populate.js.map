{"version":3,"sources":["../../src/data/populate.ts"],"sourcesContent":["import type { Collection, Field, PayloadRequest, RichTextField } from 'payload'\n\nimport { createDataloaderCacheKey } from 'payload'\n\nimport type { AdapterArguments } from '../types.js'\n\ntype Arguments = {\n  currentDepth?: number\n  data: unknown\n  depth: number\n  draft: boolean\n  field: RichTextField<any[], AdapterArguments, AdapterArguments>\n  key: number | string\n  overrideAccess?: boolean\n  req: PayloadRequest\n  showHiddenFields: boolean\n}\n\nexport const populate = async ({\n  id,\n  collection,\n  currentDepth,\n  data,\n  depth,\n  draft,\n  key,\n  overrideAccess,\n  req,\n  showHiddenFields,\n}: {\n  collection: Collection\n  field: Field\n  id: string\n} & Omit<Arguments, 'field'>): Promise<void> => {\n  const dataRef = data as Record<string, unknown>\n\n  const doc = await req.payloadDataLoader.load(\n    createDataloaderCacheKey({\n      collectionSlug: collection.config.slug,\n      currentDepth: currentDepth + 1,\n      depth,\n      docID: id,\n      draft,\n      fallbackLocale: req.locale,\n      locale: req.fallbackLocale,\n      overrideAccess: typeof overrideAccess === 'undefined' ? false : overrideAccess,\n      showHiddenFields,\n      transactionID: req.transactionID,\n    }),\n  )\n\n  if (doc) {\n    dataRef[key] = doc\n  } else {\n    dataRef[key] = null\n  }\n}\n"],"names":["createDataloaderCacheKey","populate","id","collection","currentDepth","data","depth","draft","key","overrideAccess","req","showHiddenFields","dataRef","doc","payloadDataLoader","load","collectionSlug","config","slug","docID","fallbackLocale","locale","transactionID"],"mappings":"AAEA,SAASA,wBAAwB,QAAQ,UAAS;AAgBlD,OAAO,MAAMC,WAAW,OAAO,EAC7BC,EAAE,EACFC,UAAU,EACVC,YAAY,EACZC,IAAI,EACJC,KAAK,EACLC,KAAK,EACLC,GAAG,EACHC,cAAc,EACdC,GAAG,EACHC,gBAAgB,EAKU;IAC1B,MAAMC,UAAUP;IAEhB,MAAMQ,MAAM,MAAMH,IAAII,iBAAiB,CAACC,IAAI,CAC1Cf,yBAAyB;QACvBgB,gBAAgBb,WAAWc,MAAM,CAACC,IAAI;QACtCd,cAAcA,eAAe;QAC7BE;QACAa,OAAOjB;QACPK;QACAa,gBAAgBV,IAAIW,MAAM;QAC1BA,QAAQX,IAAIU,cAAc;QAC1BX,gBAAgB,OAAOA,mBAAmB,cAAc,QAAQA;QAChEE;QACAW,eAAeZ,IAAIY,aAAa;IAClC;IAGF,IAAIT,KAAK;QACPD,OAAO,CAACJ,IAAI,GAAGK;IACjB,OAAO;QACLD,OAAO,CAACJ,IAAI,GAAG;IACjB;AACF,EAAC"}