{"version":3,"sources":["../../../src/views/Login/index.tsx"],"sourcesContent":["import type { AdminViewProps } from 'payload'\n\nimport { WithServerSideProps } from '@payloadcms/ui/shared'\nimport { redirect } from 'next/navigation.js'\nimport React, { Fragment } from 'react'\n\nimport { Logo } from '../../elements/Logo/index.js'\nimport { LoginForm } from './LoginForm/index.js'\nimport './index.scss'\n\nexport { generateLoginMetadata } from './meta.js'\n\nexport const loginBaseClass = 'login'\n\nexport const LoginView: React.FC<AdminViewProps> = ({ initPageResult, params, searchParams }) => {\n  const { locale, permissions, req } = initPageResult\n\n  const {\n    i18n,\n    payload: { config },\n    payload,\n    user,\n  } = req\n\n  const {\n    admin: { components: { afterLogin, beforeLogin } = {}, user: userSlug },\n    collections,\n    routes: { admin },\n  } = config\n\n  const BeforeLogins = Array.isArray(beforeLogin)\n    ? beforeLogin.map((Component, i) => (\n        <WithServerSideProps\n          Component={Component}\n          key={i}\n          serverOnlyProps={{\n            i18n,\n            locale,\n            params,\n            payload,\n            permissions,\n            searchParams,\n            user,\n          }}\n        />\n      ))\n    : null\n\n  const AfterLogins = Array.isArray(afterLogin)\n    ? afterLogin.map((Component, i) => (\n        <WithServerSideProps\n          Component={Component}\n          key={i}\n          serverOnlyProps={{\n            i18n,\n            locale,\n            params,\n            payload,\n            permissions,\n            searchParams,\n            user,\n          }}\n        />\n      ))\n    : null\n\n  if (user) {\n    redirect(admin)\n  }\n\n  const collectionConfig = collections.find(({ slug }) => slug === userSlug)\n\n  return (\n    <Fragment>\n      <div className={`${loginBaseClass}__brand`}>\n        <Logo\n          i18n={i18n}\n          locale={locale}\n          params={params}\n          payload={payload}\n          permissions={permissions}\n          searchParams={searchParams}\n          user={user}\n        />\n      </div>\n      {Array.isArray(BeforeLogins) && BeforeLogins.map((Component) => Component)}\n      {!collectionConfig?.auth?.disableLocalStrategy && <LoginForm searchParams={searchParams} />}\n      {Array.isArray(AfterLogins) && AfterLogins.map((Component) => Component)}\n    </Fragment>\n  )\n}\n"],"names":["WithServerSideProps","redirect","React","Fragment","Logo","LoginForm","generateLoginMetadata","loginBaseClass","LoginView","initPageResult","params","searchParams","locale","permissions","req","i18n","payload","config","user","admin","components","afterLogin","beforeLogin","userSlug","collections","routes","BeforeLogins","Array","isArray","map","Component","i","serverOnlyProps","AfterLogins","collectionConfig","find","slug","div","className","auth","disableLocalStrategy"],"mappings":";AAEA,SAASA,mBAAmB,QAAQ,wBAAuB;AAC3D,SAASC,QAAQ,QAAQ,qBAAoB;AAC7C,OAAOC,SAASC,QAAQ,QAAQ,QAAO;AAEvC,SAASC,IAAI,QAAQ,+BAA8B;AACnD,SAASC,SAAS,QAAQ,uBAAsB;AAGhD,SAASC,qBAAqB,QAAQ,YAAW;AAEjD,OAAO,MAAMC,iBAAiB,QAAO;AAErC,OAAO,MAAMC,YAAsC,CAAC,EAAEC,cAAc,EAAEC,MAAM,EAAEC,YAAY,EAAE;IAC1F,MAAM,EAAEC,MAAM,EAAEC,WAAW,EAAEC,GAAG,EAAE,GAAGL;IAErC,MAAM,EACJM,IAAI,EACJC,SAAS,EAAEC,MAAM,EAAE,EACnBD,OAAO,EACPE,IAAI,EACL,GAAGJ;IAEJ,MAAM,EACJK,OAAO,EAAEC,YAAY,EAAEC,UAAU,EAAEC,WAAW,EAAE,GAAG,CAAC,CAAC,EAAEJ,MAAMK,QAAQ,EAAE,EACvEC,WAAW,EACXC,QAAQ,EAAEN,KAAK,EAAE,EAClB,GAAGF;IAEJ,MAAMS,eAAeC,MAAMC,OAAO,CAACN,eAC/BA,YAAYO,GAAG,CAAC,CAACC,WAAWC,kBAC1B,KAAC/B;YACC8B,WAAWA;YAEXE,iBAAiB;gBACfjB;gBACAH;gBACAF;gBACAM;gBACAH;gBACAF;gBACAO;YACF;WATKa,MAYT;IAEJ,MAAME,cAAcN,MAAMC,OAAO,CAACP,cAC9BA,WAAWQ,GAAG,CAAC,CAACC,WAAWC,kBACzB,KAAC/B;YACC8B,WAAWA;YAEXE,iBAAiB;gBACfjB;gBACAH;gBACAF;gBACAM;gBACAH;gBACAF;gBACAO;YACF;WATKa,MAYT;IAEJ,IAAIb,MAAM;QACRjB,SAASkB;IACX;IAEA,MAAMe,mBAAmBV,YAAYW,IAAI,CAAC,CAAC,EAAEC,IAAI,EAAE,GAAKA,SAASb;IAEjE,qBACE,MAACpB;;0BACC,KAACkC;gBAAIC,WAAW,CAAC,EAAE/B,eAAe,OAAO,CAAC;0BACxC,cAAA,KAACH;oBACCW,MAAMA;oBACNH,QAAQA;oBACRF,QAAQA;oBACRM,SAASA;oBACTH,aAAaA;oBACbF,cAAcA;oBACdO,MAAMA;;;YAGTS,MAAMC,OAAO,CAACF,iBAAiBA,aAAaG,GAAG,CAAC,CAACC,YAAcA;YAC/D,CAACI,kBAAkBK,MAAMC,sCAAwB,KAACnC;gBAAUM,cAAcA;;YAC1EgB,MAAMC,OAAO,CAACK,gBAAgBA,YAAYJ,GAAG,CAAC,CAACC,YAAcA;;;AAGpE,EAAC"}