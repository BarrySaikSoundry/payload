{"version":3,"sources":["../../../src/views/Account/index.tsx"],"sourcesContent":["import type { AdminViewProps, ServerSideEditViewProps } from 'payload'\n\nimport { DocumentInfoProvider, FormQueryParamsProvider, HydrateClientUser } from '@payloadcms/ui'\nimport { RenderCustomComponent } from '@payloadcms/ui/shared'\nimport { notFound } from 'next/navigation.js'\nimport React from 'react'\n\nimport { DocumentHeader } from '../../elements/DocumentHeader/index.js'\nimport { getDocumentData } from '../Document/getDocumentData.js'\nimport { getDocumentPermissions } from '../Document/getDocumentPermissions.js'\nimport { EditView } from '../Edit/index.js'\nimport { Settings } from './Settings/index.js'\n\nexport { generateAccountMetadata } from './meta.js'\n\nexport const Account: React.FC<AdminViewProps> = async ({\n  initPageResult,\n  params,\n  searchParams,\n}) => {\n  const {\n    languageOptions,\n    locale,\n    permissions,\n    req,\n    req: {\n      i18n,\n      payload,\n      payload: { config },\n      user,\n    },\n  } = initPageResult\n\n  const {\n    admin: { components: { views: { Account: CustomAccountComponent } = {} } = {}, user: userSlug },\n    routes: { api },\n    serverURL,\n  } = config\n\n  const collectionConfig = config.collections.find((collection) => collection.slug === userSlug)\n\n  if (collectionConfig && user?.id) {\n    const { docPermissions, hasPublishPermission, hasSavePermission } =\n      await getDocumentPermissions({\n        id: user.id,\n        collectionConfig,\n        data: user,\n        req,\n      })\n\n    const { data, formState } = await getDocumentData({\n      id: user.id,\n      collectionConfig,\n      locale,\n      req,\n    })\n\n    const viewComponentProps: ServerSideEditViewProps = {\n      initPageResult,\n      params,\n      routeSegments: [],\n      searchParams,\n    }\n\n    return (\n      <DocumentInfoProvider\n        AfterFields={<Settings i18n={i18n} languageOptions={languageOptions} />}\n        action={`${serverURL}${api}/${userSlug}${user?.id ? `/${user.id}` : ''}`}\n        apiURL={`${serverURL}${api}/${userSlug}${user?.id ? `/${user.id}` : ''}`}\n        collectionSlug={userSlug}\n        docPermissions={docPermissions}\n        hasPublishPermission={hasPublishPermission}\n        hasSavePermission={hasSavePermission}\n        id={user?.id.toString()}\n        initialData={data}\n        initialState={formState}\n        isEditing\n      >\n        <DocumentHeader\n          collectionConfig={collectionConfig}\n          config={payload.config}\n          hideTabs\n          i18n={i18n}\n          permissions={permissions}\n        />\n        <HydrateClientUser permissions={permissions} user={user} />\n        <FormQueryParamsProvider\n          initialParams={{\n            depth: 0,\n            'fallback-locale': 'null',\n            locale: locale?.code,\n            uploadEdits: undefined,\n          }}\n        >\n          <RenderCustomComponent\n            CustomComponent={\n              typeof CustomAccountComponent === 'function' ? CustomAccountComponent : undefined\n            }\n            DefaultComponent={EditView}\n            componentProps={viewComponentProps}\n            serverOnlyProps={{\n              i18n,\n              locale,\n              params,\n              payload,\n              permissions,\n              searchParams,\n              user,\n            }}\n          />\n        </FormQueryParamsProvider>\n      </DocumentInfoProvider>\n    )\n  }\n\n  return notFound()\n}\n"],"names":["DocumentInfoProvider","FormQueryParamsProvider","HydrateClientUser","RenderCustomComponent","notFound","React","DocumentHeader","getDocumentData","getDocumentPermissions","EditView","Settings","generateAccountMetadata","Account","initPageResult","params","searchParams","languageOptions","locale","permissions","req","i18n","payload","config","user","admin","components","views","CustomAccountComponent","userSlug","routes","api","serverURL","collectionConfig","collections","find","collection","slug","id","docPermissions","hasPublishPermission","hasSavePermission","data","formState","viewComponentProps","routeSegments","AfterFields","action","apiURL","collectionSlug","toString","initialData","initialState","isEditing","hideTabs","initialParams","depth","code","uploadEdits","undefined","CustomComponent","DefaultComponent","componentProps","serverOnlyProps"],"mappings":";AAEA,SAASA,oBAAoB,EAAEC,uBAAuB,EAAEC,iBAAiB,QAAQ,iBAAgB;AACjG,SAASC,qBAAqB,QAAQ,wBAAuB;AAC7D,SAASC,QAAQ,QAAQ,qBAAoB;AAC7C,OAAOC,WAAW,QAAO;AAEzB,SAASC,cAAc,QAAQ,yCAAwC;AACvE,SAASC,eAAe,QAAQ,iCAAgC;AAChE,SAASC,sBAAsB,QAAQ,wCAAuC;AAC9E,SAASC,QAAQ,QAAQ,mBAAkB;AAC3C,SAASC,QAAQ,QAAQ,sBAAqB;AAE9C,SAASC,uBAAuB,QAAQ,YAAW;AAEnD,OAAO,MAAMC,UAAoC,OAAO,EACtDC,cAAc,EACdC,MAAM,EACNC,YAAY,EACb;IACC,MAAM,EACJC,eAAe,EACfC,MAAM,EACNC,WAAW,EACXC,GAAG,EACHA,KAAK,EACHC,IAAI,EACJC,OAAO,EACPA,SAAS,EAAEC,MAAM,EAAE,EACnBC,IAAI,EACL,EACF,GAAGV;IAEJ,MAAM,EACJW,OAAO,EAAEC,YAAY,EAAEC,OAAO,EAAEd,SAASe,sBAAsB,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAEJ,MAAMK,QAAQ,EAAE,EAC/FC,QAAQ,EAAEC,GAAG,EAAE,EACfC,SAAS,EACV,GAAGT;IAEJ,MAAMU,mBAAmBV,OAAOW,WAAW,CAACC,IAAI,CAAC,CAACC,aAAeA,WAAWC,IAAI,KAAKR;IAErF,IAAII,oBAAoBT,MAAMc,IAAI;QAChC,MAAM,EAAEC,cAAc,EAAEC,oBAAoB,EAAEC,iBAAiB,EAAE,GAC/D,MAAMhC,uBAAuB;YAC3B6B,IAAId,KAAKc,EAAE;YACXL;YACAS,MAAMlB;YACNJ;QACF;QAEF,MAAM,EAAEsB,IAAI,EAAEC,SAAS,EAAE,GAAG,MAAMnC,gBAAgB;YAChD8B,IAAId,KAAKc,EAAE;YACXL;YACAf;YACAE;QACF;QAEA,MAAMwB,qBAA8C;YAClD9B;YACAC;YACA8B,eAAe,EAAE;YACjB7B;QACF;QAEA,qBACE,MAACf;YACC6C,2BAAa,KAACnC;gBAASU,MAAMA;gBAAMJ,iBAAiBA;;YACpD8B,QAAQ,CAAC,EAAEf,UAAU,EAAED,IAAI,CAAC,EAAEF,SAAS,EAAEL,MAAMc,KAAK,CAAC,CAAC,EAAEd,KAAKc,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC;YACxEU,QAAQ,CAAC,EAAEhB,UAAU,EAAED,IAAI,CAAC,EAAEF,SAAS,EAAEL,MAAMc,KAAK,CAAC,CAAC,EAAEd,KAAKc,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC;YACxEW,gBAAgBpB;YAChBU,gBAAgBA;YAChBC,sBAAsBA;YACtBC,mBAAmBA;YACnBH,IAAId,MAAMc,GAAGY;YACbC,aAAaT;YACbU,cAAcT;YACdU,SAAS;;8BAET,KAAC9C;oBACC0B,kBAAkBA;oBAClBV,QAAQD,QAAQC,MAAM;oBACtB+B,QAAQ;oBACRjC,MAAMA;oBACNF,aAAaA;;8BAEf,KAAChB;oBAAkBgB,aAAaA;oBAAaK,MAAMA;;8BACnD,KAACtB;oBACCqD,eAAe;wBACbC,OAAO;wBACP,mBAAmB;wBACnBtC,QAAQA,QAAQuC;wBAChBC,aAAaC;oBACf;8BAEA,cAAA,KAACvD;wBACCwD,iBACE,OAAOhC,2BAA2B,aAAaA,yBAAyB+B;wBAE1EE,kBAAkBnD;wBAClBoD,gBAAgBlB;wBAChBmB,iBAAiB;4BACf1C;4BACAH;4BACAH;4BACAO;4BACAH;4BACAH;4BACAQ;wBACF;;;;;IAKV;IAEA,OAAOnB;AACT,EAAC"}