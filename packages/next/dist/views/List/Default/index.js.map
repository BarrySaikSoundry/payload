{"version":3,"sources":["../../../../src/views/List/Default/index.tsx"],"sourcesContent":["'use client'\n\nimport type { CollectionComponentMap } from '@payloadcms/ui/utilities/buildComponentMap'\n\nimport { getTranslation } from '@payloadcms/translations'\nimport {\n  Button,\n  DeleteMany,\n  EditMany,\n  Gutter,\n  ListControls,\n  ListSelection,\n  Pagination,\n  PerPage,\n  Pill,\n  PublishMany,\n  RelationshipProvider,\n  SelectionProvider,\n  SetViewActions,\n  StaggeredShimmers,\n  Table,\n  UnpublishMany,\n  useComponentMap,\n  useConfig,\n  useEditDepth,\n  useListInfo,\n  useListQuery,\n  useSearchParams,\n  useStepNav,\n  useTranslation,\n  useWindowInfo,\n} from '@payloadcms/ui'\nimport LinkImport from 'next/link.js'\nimport { formatFilesize, isNumber } from 'payload/shared'\nimport React, { Fragment, useEffect } from 'react'\n\nimport './index.scss'\n\nconst baseClass = 'collection-list'\nconst Link = (LinkImport.default || LinkImport) as unknown as typeof LinkImport.default\n\nexport const DefaultListView: React.FC = () => {\n  const { Header, collectionSlug, hasCreatePermission, newDocumentURL } = useListInfo()\n  const { data, defaultLimit, handlePageChange, handlePerPageChange } = useListQuery()\n  const { searchParams } = useSearchParams()\n\n  const config = useConfig()\n\n  const { getComponentMap } = useComponentMap()\n\n  const componentMap = getComponentMap({ collectionSlug }) as CollectionComponentMap\n\n  const {\n    AfterList,\n    AfterListTable,\n    BeforeList,\n    BeforeListTable,\n    Description,\n    actionsMap,\n    fieldMap,\n  } = componentMap || {}\n\n  const collectionConfig = config.collections.find(\n    (collection) => collection.slug === collectionSlug,\n  )\n\n  const { labels } = collectionConfig\n\n  const { i18n } = useTranslation()\n\n  const drawerDepth = useEditDepth()\n\n  const { setStepNav } = useStepNav()\n\n  const {\n    breakpoints: { s: smallBreak },\n  } = useWindowInfo()\n\n  let docs = data.docs || []\n\n  if (collectionConfig.upload) {\n    docs = docs?.map((doc) => {\n      return {\n        ...doc,\n        filesize: formatFilesize(doc.filesize),\n      }\n    })\n  }\n\n  useEffect(() => {\n    if (drawerDepth <= 1) {\n      setStepNav([\n        {\n          label: labels?.plural,\n        },\n      ])\n    }\n  }, [setStepNav, labels, drawerDepth])\n\n  return (\n    <div className={baseClass}>\n      <SetViewActions actions={actionsMap?.List} />\n      {BeforeList}\n      <SelectionProvider docs={data.docs} totalDocs={data.totalDocs}>\n        <Gutter className={`${baseClass}__wrap`}>\n          <header className={`${baseClass}__header`}>\n            {Header || (\n              <Fragment>\n                <h1>{getTranslation(labels?.plural, i18n)}</h1>\n                {hasCreatePermission && (\n                  <Pill\n                    aria-label={i18n.t('general:createNewLabel', {\n                      label: getTranslation(labels?.singular, i18n),\n                    })}\n                    to={newDocumentURL}\n                  >\n                    {i18n.t('general:createNew')}\n                  </Pill>\n                )}\n                {!smallBreak && (\n                  <ListSelection label={getTranslation(collectionConfig.labels.plural, i18n)} />\n                )}\n                {Description && <div className={`${baseClass}__sub-header`}>{Description}</div>}\n              </Fragment>\n            )}\n          </header>\n          <ListControls collectionConfig={collectionConfig} fieldMap={fieldMap} />\n          {BeforeListTable}\n          {!data.docs && (\n            <StaggeredShimmers\n              className={[`${baseClass}__shimmer`, `${baseClass}__shimmer--rows`].join(' ')}\n              count={6}\n            />\n          )}\n          {data.docs && data.docs.length > 0 && (\n            <RelationshipProvider>\n              <Table\n                customCellContext={{\n                  collectionSlug,\n                  uploadConfig: collectionConfig.upload,\n                }}\n                data={docs}\n                fieldMap={fieldMap}\n              />\n            </RelationshipProvider>\n          )}\n          {data.docs && data.docs.length === 0 && (\n            <div className={`${baseClass}__no-results`}>\n              <p>{i18n.t('general:noResults', { label: getTranslation(labels?.plural, i18n) })}</p>\n              {hasCreatePermission && newDocumentURL && (\n                <Button Link={Link} el=\"link\" to={newDocumentURL}>\n                  {i18n.t('general:createNewLabel', {\n                    label: getTranslation(labels?.singular, i18n),\n                  })}\n                </Button>\n              )}\n            </div>\n          )}\n          {AfterListTable}\n          {data.docs && data.docs.length > 0 && (\n            <div className={`${baseClass}__page-controls`}>\n              <Pagination\n                hasNextPage={data.hasNextPage}\n                hasPrevPage={data.hasPrevPage}\n                limit={data.limit}\n                nextPage={data.nextPage}\n                numberOfNeighbors={1}\n                onChange={handlePageChange}\n                page={data.page}\n                prevPage={data.prevPage}\n                totalPages={data.totalPages}\n              />\n              {data?.totalDocs > 0 && (\n                <Fragment>\n                  <div className={`${baseClass}__page-info`}>\n                    {data.page * data.limit - (data.limit - 1)}-\n                    {data.totalPages > 1 && data.totalPages !== data.page\n                      ? data.limit * data.page\n                      : data.totalDocs}{' '}\n                    {i18n.t('general:of')} {data.totalDocs}\n                  </div>\n                  <PerPage\n                    handleChange={handlePerPageChange}\n                    limit={\n                      isNumber(searchParams?.limit) ? Number(searchParams.limit) : defaultLimit\n                    }\n                    limits={collectionConfig?.admin?.pagination?.limits}\n                    resetPage={data.totalDocs <= data.pagingCounter}\n                  />\n                  {smallBreak && (\n                    <div className={`${baseClass}__list-selection`}>\n                      <Fragment>\n                        <ListSelection\n                          label={getTranslation(collectionConfig.labels.plural, i18n)}\n                        />\n                        <div className={`${baseClass}__list-selection-actions`}>\n                          <EditMany collection={collectionConfig} fieldMap={fieldMap} />\n                          <PublishMany collection={collectionConfig} />\n                          <UnpublishMany collection={collectionConfig} />\n                          <DeleteMany collection={collectionConfig} />\n                        </div>\n                      </Fragment>\n                    </div>\n                  )}\n                </Fragment>\n              )}\n            </div>\n          )}\n        </Gutter>\n      </SelectionProvider>\n      {AfterList}\n    </div>\n  )\n}\n"],"names":["getTranslation","Button","DeleteMany","EditMany","Gutter","ListControls","ListSelection","Pagination","PerPage","Pill","PublishMany","RelationshipProvider","SelectionProvider","SetViewActions","StaggeredShimmers","Table","UnpublishMany","useComponentMap","useConfig","useEditDepth","useListInfo","useListQuery","useSearchParams","useStepNav","useTranslation","useWindowInfo","LinkImport","formatFilesize","isNumber","React","Fragment","useEffect","baseClass","Link","default","DefaultListView","Header","collectionSlug","hasCreatePermission","newDocumentURL","data","defaultLimit","handlePageChange","handlePerPageChange","searchParams","config","getComponentMap","componentMap","AfterList","AfterListTable","BeforeList","BeforeListTable","Description","actionsMap","fieldMap","collectionConfig","collections","find","collection","slug","labels","i18n","drawerDepth","setStepNav","breakpoints","s","smallBreak","docs","upload","map","doc","filesize","label","plural","div","className","actions","List","totalDocs","header","h1","aria-label","t","singular","to","join","count","length","customCellContext","uploadConfig","p","el","hasNextPage","hasPrevPage","limit","nextPage","numberOfNeighbors","onChange","page","prevPage","totalPages","handleChange","Number","limits","admin","pagination","resetPage","pagingCounter"],"mappings":"AAAA;;AAIA,SAASA,cAAc,QAAQ,2BAA0B;AACzD,SACEC,MAAM,EACNC,UAAU,EACVC,QAAQ,EACRC,MAAM,EACNC,YAAY,EACZC,aAAa,EACbC,UAAU,EACVC,OAAO,EACPC,IAAI,EACJC,WAAW,EACXC,oBAAoB,EACpBC,iBAAiB,EACjBC,cAAc,EACdC,iBAAiB,EACjBC,KAAK,EACLC,aAAa,EACbC,eAAe,EACfC,SAAS,EACTC,YAAY,EACZC,WAAW,EACXC,YAAY,EACZC,eAAe,EACfC,UAAU,EACVC,cAAc,EACdC,aAAa,QACR,iBAAgB;AACvB,OAAOC,gBAAgB,eAAc;AACrC,SAASC,cAAc,EAAEC,QAAQ,QAAQ,iBAAgB;AACzD,OAAOC,SAASC,QAAQ,EAAEC,SAAS,QAAQ,QAAO;AAIlD,MAAMC,YAAY;AAClB,MAAMC,OAAQP,WAAWQ,OAAO,IAAIR;AAEpC,OAAO,MAAMS,kBAA4B;IACvC,MAAM,EAAEC,MAAM,EAAEC,cAAc,EAAEC,mBAAmB,EAAEC,cAAc,EAAE,GAAGnB;IACxE,MAAM,EAAEoB,IAAI,EAAEC,YAAY,EAAEC,gBAAgB,EAAEC,mBAAmB,EAAE,GAAGtB;IACtE,MAAM,EAAEuB,YAAY,EAAE,GAAGtB;IAEzB,MAAMuB,SAAS3B;IAEf,MAAM,EAAE4B,eAAe,EAAE,GAAG7B;IAE5B,MAAM8B,eAAeD,gBAAgB;QAAET;IAAe;IAEtD,MAAM,EACJW,SAAS,EACTC,cAAc,EACdC,UAAU,EACVC,eAAe,EACfC,WAAW,EACXC,UAAU,EACVC,QAAQ,EACT,GAAGP,gBAAgB,CAAC;IAErB,MAAMQ,mBAAmBV,OAAOW,WAAW,CAACC,IAAI,CAC9C,CAACC,aAAeA,WAAWC,IAAI,KAAKtB;IAGtC,MAAM,EAAEuB,MAAM,EAAE,GAAGL;IAEnB,MAAM,EAAEM,IAAI,EAAE,GAAGrC;IAEjB,MAAMsC,cAAc3C;IAEpB,MAAM,EAAE4C,UAAU,EAAE,GAAGxC;IAEvB,MAAM,EACJyC,aAAa,EAAEC,GAAGC,UAAU,EAAE,EAC/B,GAAGzC;IAEJ,IAAI0C,OAAO3B,KAAK2B,IAAI,IAAI,EAAE;IAE1B,IAAIZ,iBAAiBa,MAAM,EAAE;QAC3BD,OAAOA,MAAME,IAAI,CAACC;YAChB,OAAO;gBACL,GAAGA,GAAG;gBACNC,UAAU5C,eAAe2C,IAAIC,QAAQ;YACvC;QACF;IACF;IAEAxC,UAAU;QACR,IAAI+B,eAAe,GAAG;YACpBC,WAAW;gBACT;oBACES,OAAOZ,QAAQa;gBACjB;aACD;QACH;IACF,GAAG;QAACV;QAAYH;QAAQE;KAAY;IAEpC,qBACE,MAACY;QAAIC,WAAW3C;;0BACd,KAACnB;gBAAe+D,SAASvB,YAAYwB;;YACpC3B;0BACD,KAACtC;gBAAkBuD,MAAM3B,KAAK2B,IAAI;gBAAEW,WAAWtC,KAAKsC,SAAS;0BAC3D,cAAA,MAAC1E;oBAAOuE,WAAW,CAAC,EAAE3C,UAAU,MAAM,CAAC;;sCACrC,KAAC+C;4BAAOJ,WAAW,CAAC,EAAE3C,UAAU,QAAQ,CAAC;sCACtCI,wBACC,MAACN;;kDACC,KAACkD;kDAAIhF,eAAe4D,QAAQa,QAAQZ;;oCACnCvB,qCACC,KAAC7B;wCACCwE,cAAYpB,KAAKqB,CAAC,CAAC,0BAA0B;4CAC3CV,OAAOxE,eAAe4D,QAAQuB,UAAUtB;wCAC1C;wCACAuB,IAAI7C;kDAEHsB,KAAKqB,CAAC,CAAC;;oCAGX,CAAChB,4BACA,KAAC5D;wCAAckE,OAAOxE,eAAeuD,iBAAiBK,MAAM,CAACa,MAAM,EAAEZ;;oCAEtET,6BAAe,KAACsB;wCAAIC,WAAW,CAAC,EAAE3C,UAAU,YAAY,CAAC;kDAAGoB;;;;;sCAInE,KAAC/C;4BAAakD,kBAAkBA;4BAAkBD,UAAUA;;wBAC3DH;wBACA,CAACX,KAAK2B,IAAI,kBACT,KAACrD;4BACC6D,WAAW;gCAAC,CAAC,EAAE3C,UAAU,SAAS,CAAC;gCAAE,CAAC,EAAEA,UAAU,eAAe,CAAC;6BAAC,CAACqD,IAAI,CAAC;4BACzEC,OAAO;;wBAGV9C,KAAK2B,IAAI,IAAI3B,KAAK2B,IAAI,CAACoB,MAAM,GAAG,mBAC/B,KAAC5E;sCACC,cAAA,KAACI;gCACCyE,mBAAmB;oCACjBnD;oCACAoD,cAAclC,iBAAiBa,MAAM;gCACvC;gCACA5B,MAAM2B;gCACNb,UAAUA;;;wBAIfd,KAAK2B,IAAI,IAAI3B,KAAK2B,IAAI,CAACoB,MAAM,KAAK,mBACjC,MAACb;4BAAIC,WAAW,CAAC,EAAE3C,UAAU,YAAY,CAAC;;8CACxC,KAAC0D;8CAAG7B,KAAKqB,CAAC,CAAC,qBAAqB;wCAAEV,OAAOxE,eAAe4D,QAAQa,QAAQZ;oCAAM;;gCAC7EvB,uBAAuBC,gCACtB,KAACtC;oCAAOgC,MAAMA;oCAAM0D,IAAG;oCAAOP,IAAI7C;8CAC/BsB,KAAKqB,CAAC,CAAC,0BAA0B;wCAChCV,OAAOxE,eAAe4D,QAAQuB,UAAUtB;oCAC1C;;;;wBAKPZ;wBACAT,KAAK2B,IAAI,IAAI3B,KAAK2B,IAAI,CAACoB,MAAM,GAAG,mBAC/B,MAACb;4BAAIC,WAAW,CAAC,EAAE3C,UAAU,eAAe,CAAC;;8CAC3C,KAACzB;oCACCqF,aAAapD,KAAKoD,WAAW;oCAC7BC,aAAarD,KAAKqD,WAAW;oCAC7BC,OAAOtD,KAAKsD,KAAK;oCACjBC,UAAUvD,KAAKuD,QAAQ;oCACvBC,mBAAmB;oCACnBC,UAAUvD;oCACVwD,MAAM1D,KAAK0D,IAAI;oCACfC,UAAU3D,KAAK2D,QAAQ;oCACvBC,YAAY5D,KAAK4D,UAAU;;gCAE5B5D,MAAMsC,YAAY,mBACjB,MAAChD;;sDACC,MAAC4C;4CAAIC,WAAW,CAAC,EAAE3C,UAAU,WAAW,CAAC;;gDACtCQ,KAAK0D,IAAI,GAAG1D,KAAKsD,KAAK,GAAItD,CAAAA,KAAKsD,KAAK,GAAG,CAAA;gDAAG;gDAC1CtD,KAAK4D,UAAU,GAAG,KAAK5D,KAAK4D,UAAU,KAAK5D,KAAK0D,IAAI,GACjD1D,KAAKsD,KAAK,GAAGtD,KAAK0D,IAAI,GACtB1D,KAAKsC,SAAS;gDAAE;gDACnBjB,KAAKqB,CAAC,CAAC;gDAAc;gDAAE1C,KAAKsC,SAAS;;;sDAExC,KAACtE;4CACC6F,cAAc1D;4CACdmD,OACElE,SAASgB,cAAckD,SAASQ,OAAO1D,aAAakD,KAAK,IAAIrD;4CAE/D8D,QAAQhD,kBAAkBiD,OAAOC,YAAYF;4CAC7CG,WAAWlE,KAAKsC,SAAS,IAAItC,KAAKmE,aAAa;;wCAEhDzC,4BACC,KAACQ;4CAAIC,WAAW,CAAC,EAAE3C,UAAU,gBAAgB,CAAC;sDAC5C,cAAA,MAACF;;kEACC,KAACxB;wDACCkE,OAAOxE,eAAeuD,iBAAiBK,MAAM,CAACa,MAAM,EAAEZ;;kEAExD,MAACa;wDAAIC,WAAW,CAAC,EAAE3C,UAAU,wBAAwB,CAAC;;0EACpD,KAAC7B;gEAASuD,YAAYH;gEAAkBD,UAAUA;;0EAClD,KAAC5C;gEAAYgD,YAAYH;;0EACzB,KAACvC;gEAAc0C,YAAYH;;0EAC3B,KAACrD;gEAAWwD,YAAYH;;;;;;;;;;;;;;YAW3CP;;;AAGP,EAAC"}