{"version":3,"sources":["../../../src/layouts/Root/index.tsx"],"sourcesContent":["import type { AcceptedLanguages, I18nClient } from '@payloadcms/translations'\nimport type { SanitizedConfig } from 'payload'\n\nimport { initI18n, rtlLanguages } from '@payloadcms/translations'\nimport { RootProvider } from '@payloadcms/ui'\nimport '@payloadcms/ui/scss/app.scss'\nimport { buildComponentMap } from '@payloadcms/ui/utilities/buildComponentMap'\nimport { Merriweather } from 'next/font/google'\nimport { headers as getHeaders, cookies as nextCookies } from 'next/headers.js'\nimport { createClientConfig, parseCookies } from 'payload'\nimport React from 'react'\n\nimport { getPayloadHMR } from '../../utilities/getPayloadHMR.js'\nimport { getRequestLanguage } from '../../utilities/getRequestLanguage.js'\nimport { getRequestTheme } from '../../utilities/getRequestTheme.js'\nimport { DefaultEditView } from '../../views/Edit/Default/index.js'\nimport { DefaultListView } from '../../views/List/Default/index.js'\n\nconst merriweather = Merriweather({\n  display: 'swap',\n  style: ['normal', 'italic'],\n  subsets: ['latin'],\n  variable: '--font-serif',\n  weight: ['400', '900'],\n})\n\nexport const metadata = {\n  description: 'Generated by Next.js',\n  title: 'Next.js',\n}\n\nexport const RootLayout = async ({\n  children,\n  config: configPromise,\n}: {\n  children: React.ReactNode\n  config: Promise<SanitizedConfig>\n}) => {\n  const config = await configPromise\n\n  const headers = getHeaders()\n  const cookies = parseCookies(headers)\n\n  const languageCode = getRequestLanguage({\n    config,\n    cookies,\n    headers,\n  })\n\n  const theme = getRequestTheme({\n    config,\n    cookies,\n    headers,\n  })\n\n  const payload = await getPayloadHMR({ config })\n\n  const i18n: I18nClient = await initI18n({\n    config: config.i18n,\n    context: 'client',\n    language: languageCode,\n  })\n\n  const clientConfig = await createClientConfig({ config, t: i18n.t })\n\n  const dir = (rtlLanguages as unknown as AcceptedLanguages[]).includes(languageCode)\n    ? 'RTL'\n    : 'LTR'\n\n  const languageOptions = Object.entries(config.i18n.supportedLanguages || {}).reduce(\n    (acc, [language, languageConfig]) => {\n      if (Object.keys(config.i18n.supportedLanguages).includes(language)) {\n        acc.push({\n          label: languageConfig.translations.general.thisLanguage,\n          value: language,\n        })\n      }\n\n      return acc\n    },\n    [],\n  )\n\n  // eslint-disable-next-line @typescript-eslint/require-await\n  async function switchLanguageServerAction(lang: string): Promise<void> {\n    'use server'\n    nextCookies().set({\n      name: `${config.cookiePrefix || 'payload'}-lng`,\n      path: '/',\n      value: lang,\n    })\n  }\n\n  const { componentMap, wrappedChildren } = buildComponentMap({\n    DefaultEditView,\n    DefaultListView,\n    children,\n    i18n,\n    payload,\n  })\n\n  return (\n    <html className={merriweather.variable} data-theme={theme} dir={dir} lang={languageCode}>\n      <body>\n        <RootProvider\n          componentMap={componentMap}\n          config={clientConfig}\n          dateFNSKey={i18n.dateFNSKey}\n          fallbackLang={clientConfig.i18n.fallbackLanguage}\n          languageCode={languageCode}\n          languageOptions={languageOptions}\n          switchLanguageServerAction={switchLanguageServerAction}\n          theme={theme}\n          translations={i18n.translations}\n        >\n          {wrappedChildren}\n        </RootProvider>\n        <div id=\"portal\" />\n      </body>\n    </html>\n  )\n}\n"],"names":["initI18n","rtlLanguages","RootProvider","buildComponentMap","Merriweather","headers","getHeaders","cookies","nextCookies","createClientConfig","parseCookies","React","getPayloadHMR","getRequestLanguage","getRequestTheme","DefaultEditView","DefaultListView","merriweather","display","style","subsets","variable","weight","metadata","description","title","RootLayout","children","config","configPromise","languageCode","theme","payload","i18n","context","language","clientConfig","t","dir","includes","languageOptions","Object","entries","supportedLanguages","reduce","acc","languageConfig","keys","push","label","translations","general","thisLanguage","value","switchLanguageServerAction","lang","set","name","cookiePrefix","path","componentMap","wrappedChildren","html","className","data-theme","body","dateFNSKey","fallbackLang","fallbackLanguage","div","id"],"mappings":";AAGA,SAASA,QAAQ,EAAEC,YAAY,QAAQ,2BAA0B;AACjE,SAASC,YAAY,QAAQ,iBAAgB;AAE7C,SAASC,iBAAiB,QAAQ,6CAA4C;AAC9E,SAASC,YAAY,QAAQ,mBAAkB;AAC/C,SAASC,WAAWC,UAAU,EAAEC,WAAWC,WAAW,QAAQ,kBAAiB;AAC/E,SAASC,kBAAkB,EAAEC,YAAY,QAAQ,UAAS;AAC1D,OAAOC,WAAW,QAAO;AAEzB,SAASC,aAAa,QAAQ,mCAAkC;AAChE,SAASC,kBAAkB,QAAQ,wCAAuC;AAC1E,SAASC,eAAe,QAAQ,qCAAoC;AACpE,SAASC,eAAe,QAAQ,oCAAmC;AACnE,SAASC,eAAe,QAAQ,oCAAmC;AAEnE,MAAMC,eAAeb,aAAa;IAChCc,SAAS;IACTC,OAAO;QAAC;QAAU;KAAS;IAC3BC,SAAS;QAAC;KAAQ;IAClBC,UAAU;IACVC,QAAQ;QAAC;QAAO;KAAM;AACxB;AAEA,OAAO,MAAMC,WAAW;IACtBC,aAAa;IACbC,OAAO;AACT,EAAC;AAED,OAAO,MAAMC,aAAa,OAAO,EAC/BC,QAAQ,EACRC,QAAQC,aAAa,EAItB;IACC,MAAMD,SAAS,MAAMC;IAErB,MAAMxB,UAAUC;IAChB,MAAMC,UAAUG,aAAaL;IAE7B,MAAMyB,eAAejB,mBAAmB;QACtCe;QACArB;QACAF;IACF;IAEA,MAAM0B,QAAQjB,gBAAgB;QAC5Bc;QACArB;QACAF;IACF;IAEA,MAAM2B,UAAU,MAAMpB,cAAc;QAAEgB;IAAO;IAE7C,MAAMK,OAAmB,MAAMjC,SAAS;QACtC4B,QAAQA,OAAOK,IAAI;QACnBC,SAAS;QACTC,UAAUL;IACZ;IAEA,MAAMM,eAAe,MAAM3B,mBAAmB;QAAEmB;QAAQS,GAAGJ,KAAKI,CAAC;IAAC;IAElE,MAAMC,MAAM,AAACrC,aAAgDsC,QAAQ,CAACT,gBAClE,QACA;IAEJ,MAAMU,kBAAkBC,OAAOC,OAAO,CAACd,OAAOK,IAAI,CAACU,kBAAkB,IAAI,CAAC,GAAGC,MAAM,CACjF,CAACC,KAAK,CAACV,UAAUW,eAAe;QAC9B,IAAIL,OAAOM,IAAI,CAACnB,OAAOK,IAAI,CAACU,kBAAkB,EAAEJ,QAAQ,CAACJ,WAAW;YAClEU,IAAIG,IAAI,CAAC;gBACPC,OAAOH,eAAeI,YAAY,CAACC,OAAO,CAACC,YAAY;gBACvDC,OAAOlB;YACT;QACF;QAEA,OAAOU;IACT,GACA,EAAE;IAGJ,4DAA4D;IAC5D,eAAeS,2BAA2BC,IAAY;QACpD;QACA/C,cAAcgD,GAAG,CAAC;YAChBC,MAAM,CAAC,EAAE7B,OAAO8B,YAAY,IAAI,UAAU,IAAI,CAAC;YAC/CC,MAAM;YACNN,OAAOE;QACT;IACF;IAEA,MAAM,EAAEK,YAAY,EAAEC,eAAe,EAAE,GAAG1D,kBAAkB;QAC1DY;QACAC;QACAW;QACAM;QACAD;IACF;IAEA,qBACE,KAAC8B;QAAKC,WAAW9C,aAAaI,QAAQ;QAAE2C,cAAYjC;QAAOO,KAAKA;QAAKiB,MAAMzB;kBACzE,cAAA,MAACmC;;8BACC,KAAC/D;oBACC0D,cAAcA;oBACdhC,QAAQQ;oBACR8B,YAAYjC,KAAKiC,UAAU;oBAC3BC,cAAc/B,aAAaH,IAAI,CAACmC,gBAAgB;oBAChDtC,cAAcA;oBACdU,iBAAiBA;oBACjBc,4BAA4BA;oBAC5BvB,OAAOA;oBACPmB,cAAcjB,KAAKiB,YAAY;8BAE9BW;;8BAEH,KAACQ;oBAAIC,IAAG;;;;;AAIhB,EAAC"}