{"version":3,"sources":["../../../src/utilities/initPage/handleAdminPage.ts"],"sourcesContent":["import type {\n  Permissions,\n  SanitizedCollectionConfig,\n  SanitizedConfig,\n  SanitizedGlobalConfig,\n} from 'payload'\n\nimport { notFound } from 'next/navigation.js'\n\nimport { isAdminAuthRoute, isAdminRoute } from './shared.js'\n\nexport const handleAdminPage = ({\n  adminRoute,\n  config,\n  permissions,\n  route,\n}: {\n  adminRoute: string\n  config: SanitizedConfig\n  permissions: Permissions\n  route: string\n}) => {\n  if (isAdminRoute(route, adminRoute)) {\n    const routeSegments = route.replace(adminRoute, '').split('/').filter(Boolean)\n    const [entityType, entitySlug, createOrID] = routeSegments\n    const collectionSlug = entityType === 'collections' ? entitySlug : undefined\n    const globalSlug = entityType === 'globals' ? entitySlug : undefined\n    const docID = collectionSlug && createOrID !== 'create' ? createOrID : undefined\n\n    let collectionConfig: SanitizedCollectionConfig | undefined\n    let globalConfig: SanitizedGlobalConfig | undefined\n\n    if (collectionSlug) {\n      collectionConfig = config.collections.find((collection) => collection.slug === collectionSlug)\n\n      if (!collectionConfig) {\n        notFound()\n      }\n    }\n\n    if (globalSlug) {\n      globalConfig = config.globals.find((global) => global.slug === globalSlug)\n\n      if (!globalConfig) {\n        notFound()\n      }\n    }\n\n    if (!permissions.canAccessAdmin && !isAdminAuthRoute(config, route, adminRoute)) {\n      notFound()\n    }\n\n    return {\n      collectionConfig,\n      docID,\n      globalConfig,\n    }\n  }\n}\n"],"names":["notFound","isAdminAuthRoute","isAdminRoute","handleAdminPage","adminRoute","config","permissions","route","routeSegments","replace","split","filter","Boolean","entityType","entitySlug","createOrID","collectionSlug","undefined","globalSlug","docID","collectionConfig","globalConfig","collections","find","collection","slug","globals","global","canAccessAdmin"],"mappings":"AAOA,SAASA,QAAQ,QAAQ,qBAAoB;AAE7C,SAASC,gBAAgB,EAAEC,YAAY,QAAQ,cAAa;AAE5D,OAAO,MAAMC,kBAAkB,CAAC,EAC9BC,UAAU,EACVC,MAAM,EACNC,WAAW,EACXC,KAAK,EAMN;IACC,IAAIL,aAAaK,OAAOH,aAAa;QACnC,MAAMI,gBAAgBD,MAAME,OAAO,CAACL,YAAY,IAAIM,KAAK,CAAC,KAAKC,MAAM,CAACC;QACtE,MAAM,CAACC,YAAYC,YAAYC,WAAW,GAAGP;QAC7C,MAAMQ,iBAAiBH,eAAe,gBAAgBC,aAAaG;QACnE,MAAMC,aAAaL,eAAe,YAAYC,aAAaG;QAC3D,MAAME,QAAQH,kBAAkBD,eAAe,WAAWA,aAAaE;QAEvE,IAAIG;QACJ,IAAIC;QAEJ,IAAIL,gBAAgB;YAClBI,mBAAmBf,OAAOiB,WAAW,CAACC,IAAI,CAAC,CAACC,aAAeA,WAAWC,IAAI,KAAKT;YAE/E,IAAI,CAACI,kBAAkB;gBACrBpB;YACF;QACF;QAEA,IAAIkB,YAAY;YACdG,eAAehB,OAAOqB,OAAO,CAACH,IAAI,CAAC,CAACI,SAAWA,OAAOF,IAAI,KAAKP;YAE/D,IAAI,CAACG,cAAc;gBACjBrB;YACF;QACF;QAEA,IAAI,CAACM,YAAYsB,cAAc,IAAI,CAAC3B,iBAAiBI,QAAQE,OAAOH,aAAa;YAC/EJ;QACF;QAEA,OAAO;YACLoB;YACAD;YACAE;QACF;IACF;AACF,EAAC"}