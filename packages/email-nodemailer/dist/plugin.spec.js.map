{"version":3,"sources":["../src/plugin.spec.ts"],"sourcesContent":["import { jest } from '@jest/globals'\n\nimport nodemailer, { Transporter } from 'nodemailer'\nimport { nodemailerAdapter, NodemailerAdapterArgs } from './index.js'\n\nconst defaultArgs: NodemailerAdapterArgs = {\n  defaultFromAddress: 'test@test.com',\n  defaultFromName: 'Test',\n}\n\ndescribe('email-nodemailer', () => {\n\n  describe('transport verification', () => {\n    let mockedVerify: jest.Mock<Transporter['verify']>\n    let mockTransport: Transporter\n\n    beforeEach(() => {\n      mockedVerify = jest.fn<Transporter['verify']>()\n      mockTransport = nodemailer.createTransport({\n        name: 'existing-transport',\n        // eslint-disable-next-line @typescript-eslint/require-await\n        send: async (mail) => {\n          console.log('mock send', mail)\n        },\n        version: '0.0.1',\n        verify: mockedVerify,\n      })\n    })\n\n    it('should be invoked when skipVerify = false', async () => {\n      await nodemailerAdapter({\n        ...defaultArgs,\n        transport: mockTransport,\n        skipVerify: false,\n      })\n\n      expect(mockedVerify.mock.calls).toHaveLength(1)\n    })\n\n    it('should be invoked when skipVerify is undefined', async () => {\n      await nodemailerAdapter({\n        ...defaultArgs,\n        transport: mockTransport,\n        skipVerify: false,\n      })\n\n      expect(mockedVerify.mock.calls).toHaveLength(1)\n    })\n\n    it('should not be invoked when skipVerify = true', async () => {\n      await nodemailerAdapter({\n        ...defaultArgs,\n        transport: mockTransport,\n        skipVerify: true,\n      })\n\n      expect(mockedVerify.mock.calls).toHaveLength(0)\n    })\n  })\n})\n"],"names":["jest","nodemailer","nodemailerAdapter","defaultArgs","defaultFromAddress","defaultFromName","describe","mockedVerify","mockTransport","beforeEach","fn","createTransport","name","send","mail","console","log","version","verify","it","transport","skipVerify","expect","mock","calls","toHaveLength"],"mappings":"AAAA,SAASA,IAAI,QAAQ,gBAAe;AAEpC,OAAOC,gBAAiC,aAAY;AACpD,SAASC,iBAAiB,QAA+B,aAAY;AAErE,MAAMC,cAAqC;IACzCC,oBAAoB;IACpBC,iBAAiB;AACnB;AAEAC,SAAS,oBAAoB;IAE3BA,SAAS,0BAA0B;QACjC,IAAIC;QACJ,IAAIC;QAEJC,WAAW;YACTF,eAAeP,KAAKU,EAAE;YACtBF,gBAAgBP,WAAWU,eAAe,CAAC;gBACzCC,MAAM;gBACN,4DAA4D;gBAC5DC,MAAM,OAAOC;oBACXC,QAAQC,GAAG,CAAC,aAAaF;gBAC3B;gBACAG,SAAS;gBACTC,QAAQX;YACV;QACF;QAEAY,GAAG,6CAA6C;YAC9C,MAAMjB,kBAAkB;gBACtB,GAAGC,WAAW;gBACdiB,WAAWZ;gBACXa,YAAY;YACd;YAEAC,OAAOf,aAAagB,IAAI,CAACC,KAAK,EAAEC,YAAY,CAAC;QAC/C;QAEAN,GAAG,kDAAkD;YACnD,MAAMjB,kBAAkB;gBACtB,GAAGC,WAAW;gBACdiB,WAAWZ;gBACXa,YAAY;YACd;YAEAC,OAAOf,aAAagB,IAAI,CAACC,KAAK,EAAEC,YAAY,CAAC;QAC/C;QAEAN,GAAG,gDAAgD;YACjD,MAAMjB,kBAAkB;gBACtB,GAAGC,WAAW;gBACdiB,WAAWZ;gBACXa,YAAY;YACd;YAEAC,OAAOf,aAAagB,IAAI,CAACC,KAAK,EAAEC,YAAY,CAAC;QAC/C;IACF;AACF"}