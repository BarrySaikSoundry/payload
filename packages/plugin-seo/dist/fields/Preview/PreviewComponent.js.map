{"version":3,"sources":["../../../src/fields/Preview/PreviewComponent.tsx"],"sourcesContent":["'use client'\n\nimport type { FormField, UIField } from 'payload'\n\nimport {\n  useAllFormFields,\n  useDocumentInfo,\n  useForm,\n  useLocale,\n  useTranslation,\n} from '@payloadcms/ui'\nimport { get } from 'http'\nimport React, { useEffect, useState } from 'react'\n\nimport type { PluginSEOTranslationKeys, PluginSEOTranslations } from '../../translations/index.js'\nimport type { GenerateURL } from '../../types.js'\n\ntype PreviewProps = {\n  descriptionPath?: string\n  hasGenerateURLFn: boolean\n  titlePath?: string\n} & UIField\n\nexport const PreviewComponent: React.FC<PreviewProps> = ({\n  descriptionPath: descriptionPathFromContext,\n  hasGenerateURLFn,\n  titlePath: titlePathFromContext,\n}) => {\n  const { t } = useTranslation<PluginSEOTranslations, PluginSEOTranslationKeys>()\n\n  const locale = useLocale()\n  const [fields] = useAllFormFields()\n  const { getData } = useForm()\n  const docInfo = useDocumentInfo()\n\n  const descriptionPath = descriptionPathFromContext || 'meta.description'\n  const titlePath = titlePathFromContext || 'meta.title'\n\n  const {\n    [descriptionPath]: { value: metaDescription } = {} as FormField,\n    [titlePath]: { value: metaTitle } = {} as FormField,\n  } = fields\n\n  const [href, setHref] = useState<string>()\n\n  useEffect(() => {\n    const getHref = async () => {\n      const genURLResponse = await fetch('/api/plugin-seo/generate-url', {\n        body: JSON.stringify({\n          ...docInfo,\n          doc: { ...getData() },\n          locale: typeof locale === 'object' ? locale?.code : locale,\n        } satisfies Parameters<GenerateURL>[0]),\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        method: 'POST',\n      })\n\n      const { result: newHref } = await genURLResponse.json()\n\n      setHref(newHref)\n    }\n\n    if (hasGenerateURLFn && !href) {\n      void getHref()\n    }\n  }, [fields, href, locale, docInfo, hasGenerateURLFn, getData])\n\n  return (\n    <div>\n      <div>{t('plugin-seo:preview')}</div>\n      <div\n        style={{\n          color: '#9A9A9A',\n          marginBottom: '5px',\n        }}\n      >\n        {t('plugin-seo:previewDescription')}\n      </div>\n      <div\n        style={{\n          background: 'var(--theme-elevation-50)',\n          borderRadius: '5px',\n          boxShadow: '0px 0px 10px rgba(0, 0, 0, 0.1)',\n          maxWidth: '600px',\n          padding: '20px',\n          pointerEvents: 'none',\n          width: '100%',\n        }}\n      >\n        <div>\n          <a\n            href={href}\n            style={{\n              textDecoration: 'none',\n            }}\n          >\n            {href || 'https://...'}\n          </a>\n        </div>\n        <h4\n          style={{\n            margin: 0,\n          }}\n        >\n          <a\n            href=\"/\"\n            style={{\n              textDecoration: 'none',\n            }}\n          >\n            {metaTitle as string}\n          </a>\n        </h4>\n        <p\n          style={{\n            margin: 0,\n          }}\n        >\n          {metaDescription as string}\n        </p>\n      </div>\n    </div>\n  )\n}\n"],"names":["useAllFormFields","useDocumentInfo","useForm","useLocale","useTranslation","React","useEffect","useState","PreviewComponent","descriptionPath","descriptionPathFromContext","hasGenerateURLFn","titlePath","titlePathFromContext","t","locale","fields","getData","docInfo","value","metaDescription","metaTitle","href","setHref","getHref","genURLResponse","fetch","body","JSON","stringify","doc","code","credentials","headers","method","result","newHref","json","div","style","color","marginBottom","background","borderRadius","boxShadow","maxWidth","padding","pointerEvents","width","a","textDecoration","h4","margin","p"],"mappings":"AAAA;;AAIA,SACEA,gBAAgB,EAChBC,eAAe,EACfC,OAAO,EACPC,SAAS,EACTC,cAAc,QACT,iBAAgB;AAEvB,OAAOC,SAASC,SAAS,EAAEC,QAAQ,QAAQ,QAAO;AAWlD,OAAO,MAAMC,mBAA2C,CAAC,EACvDC,iBAAiBC,0BAA0B,EAC3CC,gBAAgB,EAChBC,WAAWC,oBAAoB,EAChC;IACC,MAAM,EAAEC,CAAC,EAAE,GAAGV;IAEd,MAAMW,SAASZ;IACf,MAAM,CAACa,OAAO,GAAGhB;IACjB,MAAM,EAAEiB,OAAO,EAAE,GAAGf;IACpB,MAAMgB,UAAUjB;IAEhB,MAAMQ,kBAAkBC,8BAA8B;IACtD,MAAME,YAAYC,wBAAwB;IAE1C,MAAM,EACJ,CAACJ,gBAAgB,EAAE,EAAEU,OAAOC,eAAe,EAAE,GAAG,CAAC,CAAc,EAC/D,CAACR,UAAU,EAAE,EAAEO,OAAOE,SAAS,EAAE,GAAG,CAAC,CAAc,EACpD,GAAGL;IAEJ,MAAM,CAACM,MAAMC,QAAQ,GAAGhB;IAExBD,UAAU;QACR,MAAMkB,UAAU;YACd,MAAMC,iBAAiB,MAAMC,MAAM,gCAAgC;gBACjEC,MAAMC,KAAKC,SAAS,CAAC;oBACnB,GAAGX,OAAO;oBACVY,KAAK;wBAAE,GAAGb,SAAS;oBAAC;oBACpBF,QAAQ,OAAOA,WAAW,WAAWA,QAAQgB,OAAOhB;gBACtD;gBACAiB,aAAa;gBACbC,SAAS;oBACP,gBAAgB;gBAClB;gBACAC,QAAQ;YACV;YAEA,MAAM,EAAEC,QAAQC,OAAO,EAAE,GAAG,MAAMX,eAAeY,IAAI;YAErDd,QAAQa;QACV;QAEA,IAAIzB,oBAAoB,CAACW,MAAM;YAC7B,KAAKE;QACP;IACF,GAAG;QAACR;QAAQM;QAAMP;QAAQG;QAASP;QAAkBM;KAAQ;IAE7D,qBACE,MAACqB;;0BACC,KAACA;0BAAKxB,EAAE;;0BACR,KAACwB;gBACCC,OAAO;oBACLC,OAAO;oBACPC,cAAc;gBAChB;0BAEC3B,EAAE;;0BAEL,MAACwB;gBACCC,OAAO;oBACLG,YAAY;oBACZC,cAAc;oBACdC,WAAW;oBACXC,UAAU;oBACVC,SAAS;oBACTC,eAAe;oBACfC,OAAO;gBACT;;kCAEA,KAACV;kCACC,cAAA,KAACW;4BACC3B,MAAMA;4BACNiB,OAAO;gCACLW,gBAAgB;4BAClB;sCAEC5B,QAAQ;;;kCAGb,KAAC6B;wBACCZ,OAAO;4BACLa,QAAQ;wBACV;kCAEA,cAAA,KAACH;4BACC3B,MAAK;4BACLiB,OAAO;gCACLW,gBAAgB;4BAClB;sCAEC7B;;;kCAGL,KAACgC;wBACCd,OAAO;4BACLa,QAAQ;wBACV;kCAEChC;;;;;;AAKX,EAAC"}